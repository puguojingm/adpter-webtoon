
import { NovelType } from '../../types';

import {getGenreStrategy} from './novelType';

export const getBreakPlotMethod = (batchSize: number, genre: NovelType) => `
---
name: break-plot-method
description: 网文改编漫剧剧情拆解方法论、适用于60万-300万字长篇小说改编为动态漫剧，包含冲突提取、情绪钩子识别、剧情拆解、分集标注、节奏控制等全流程指导
---

# 总则
## 总体取向

**改编的本质**：不是"翻译"，而是"重构"

网文改编漫剧的核心是**提取情绪钩子、压缩冲突密度、转化视觉语言、重构叙事节奏**。

**核心原则**：
- 情绪钩子密度 > 故事完整性
- 视觉冲击力 > 文学性描写
- 快节奏刺激 > 慢节奏沉浸
- 算法友好性 > 戏剧逻辑性

**改编对象**：
- **小说类型**：玄幻、武侠、都市、言情、古言、悬疑、推理、科幻、末世、重生等所有类型
- **小说长度**：60万-300万字长篇网文
- **目标产品**：动态集数漫剧（每集1-2分钟，集数根据内容自然生成）

**漫剧基本规格**：
- **每集时长**：1-2分钟
- **每集字数**：500-800字
- **集数**：根据小说内容自然生成（不提前设定）

---

## 整体改编公式
\`\`\`
网文改编漫剧 = 情绪钩子提取 + 冲突密度压缩 + 视觉语言转化 + 节奏强制重构
\`\`\`

**叙事结构**：
- **季弧（整体）**：保持小说原有故事结构，不强行重构
- **集内（单集）**：采用起承转钩四段式（起-开场冲突、承-推进发展、转-反转高潮、钩-悬念结尾）

**改编思维转换**：

| 维度 | 原创思维 | 改编思维 |
|------|---------|---------|
| **起点** | 从零构思故事 | 从已有小说提取精华 |
| **目标** | 讲好一个故事 | 提取最爽的情绪钩子 |
| **结构** | 自由设计 | 尊重小说原有结构，不强行重构 |
| **人物** | 自由创造 | 从小说提取，需简化 |
| **节奏** | 自由把控 | 需大幅压缩，删繁就简 |
| **集数** | 自由确定 | 根据内容密度自然生成 |

# 剧情拆解方法论

## 一、冲突点识别与提取

### 冲突点定义

**什么是冲突点**：
- 推动情节发展的关键事件
- 让观众产生情绪波动的时刻
- 角色之间的对立和碰撞
- 主角面临的挑战和危机

**冲突点 ≠ 情节点**：
- 情节点：所有发生的事件（包括过渡、铺垫、日常）
- 冲突点：有张力、有对立、有情绪的事件

---

### 冲突点识别方法

**识别标准**：

**A. 强度分级**

| 等级 | 定义 | 特征 | 改编策略 |
|------|------|------|---------|
| **⭐⭐⭐ 核心冲突** | 推动主线的关键事件 | 改变主角命运、大幅改变格局 | 必须保留，独立成集 |
| **⭐⭐ 次级冲突** | 推动支线或铺垫的事件 | 推进剧情但非关键转折 | 选择性保留，可合并 |
| **⭐ 过渡冲突** | 日常、铺垫、环境描写 | 无明显对立和张力 | 删除或极度压缩 |

**B. 类型识别**（跨类型通用）

| 冲突类型 | 定义 | 示例 |
|---------|------|------|
| **人物对立** | 角色之间的直接冲突 | 主角vs反派、误会、背叛 |
| **力量对比** | 实力差距引发的冲突 | 越级挑战、碾压、觉醒 |
| **身份矛盾** | 身份差异引发的冲突 | 贵贱对立、隐藏身份、真相揭露 |
| **情感纠葛** | 情感关系引发的冲突 | 误会、背叛、虐恋、三角恋 |
| **生存危机** | 生死存亡的冲突 | 追杀、危机、末世、绝境 |
| **真相悬念** | 谜团引发的冲突 | 凶手是谁、幕后黑手、身世之谜 |

---

### 冲突点提取策略

**提取步骤**：

**第一步：批量阅读**
- 每次阅读${batchSize}章（约12000-24000字）
- 快速识别所有冲突点
- 标注冲突类型和强度

**第二步：筛选分级**
- ⭐⭐⭐ 核心冲突：标记为"必保留"
- ⭐⭐ 次级冲突：标记为"可保留"
- ⭐ 过渡冲突：标记为"删除"

**第三步：密度统计**
\`\`\`
冲突密度 = ${batchSize}章内的核心冲突数量

高密度：${batchSize}章内有 5个以上核心冲突
中密度：${batchSize}章内有 2-4个核心冲突  
低密度：${batchSize}章内有 0-1个核心冲突
\`\`\`

**第四步：改编策略**
- 高密度：保留大部分冲突，适度合并
- 中密度：保留核心冲突，删除次级冲突
- 低密度：只保留核心冲突，大量压缩

---

### 冲突点识别模板

**标准识别清单**（每${batchSize}章填写）：
\`\`\`markdown
## 第[X-X]章 冲突点识别清单

### 核心冲突（⭐⭐⭐）
1. **冲突描述**：[...]
   - 位置：第X章
   - 类型：[人物对立/力量对比/身份矛盾/情感纠葛/生存危机/真相悬念]
   - 涉及角色：[主角vs谁]
   - 情绪强度：[1-10分]
   - 改编价值：[高/中/低]

2. **冲突描述**：[...]
   - ...

### 次级冲突（⭐⭐）
1. **冲突描述**：[...]
   - ...

### 冲突密度评估
- 核心冲突数量：[X个]
- 密度评级：[高/中/低]
- 压缩策略：[...]
\`\`\`

---

## 二、情绪钩子提取与标注

### 情绪钩子定义

**什么是情绪钩子**：
- 能让观众产生强烈情绪反应的情节点
- 让观众"卧槽/爽/哭/笑/急"的时刻
- 短视频中让观众停留的"钩子"

**情绪钩子 vs 冲突点**：
- 冲突点：所有有对立的事件
- 情绪钩子：冲突点中最能引发情绪的高潮时刻

---

### 情绪钩子类型（跨类型通用）

**通用情绪钩子清单**：

| 情绪类型 | 钩子示例 | 适用类型 |
|---------|---------|---------|
| **爽感钩子** | 打脸、碾压、装X、反杀、复仇成功 | 玄幻、都市、武侠、重生 |
| **虐心钩子** | 误会、背叛、生离死别、痛苦抉择 | 言情、古言 |
| **悬疑钩子** | 真相揭露、身份曝光、反转、揭秘 | 悬疑、推理 |
| **紧张钩子** | 危机、追杀、死亡威胁、倒计时 | 科幻、末世、动作 |
| **温情钩子** | 守护、牺牲、感动、团圆 | 所有类型 |
| **反差钩子** | 身份反转、实力曝光、扮猪吃虎 | 所有类型 |

**不同类型的专属钩子**：

**玄幻/武侠**：
- 境界突破、越级碾压、身份曝光、血脉觉醒
- 打脸羞辱、宗门大比、秘境奇遇、宝物争夺

**都市/现代**：
- 身份揭露、财富对比、地位碾压、真相大白
- 前妻后悔、商战对决、阴谋揭穿、豪门恩怨

**言情/古言**：
- 误会解除、虐恋虐心、真心表白、强制爱
- 破镜重圆、宠溺反差、吃醋争风、生离死别

**悬疑/推理**：
- 凶手曝光、真相反转、证据发现、关键线索
- 危机时刻、死亡威胁、时间倒计时、最后一搏

**科幻/末世**：
- 异能觉醒、丧尸危机、基地争夺、黑科技展示
- 人性考验、背叛求生、团队对抗、终极一战

**重生复仇**：
- 先知剧情、改变命运、打脸前世仇敌、提前布局
- 夺取机缘、避开危险、身份反转、复仇成功

---

### 情绪钩子提取方法

**提取标准**：

**A. 情绪强度评分**（1-10分）
\`\`\`
10分：让观众"卧槽！"的时刻（必须单独成集）
8-9分：让观众爽/虐/急的高潮（核心爽点）
6-7分：让观众有感觉的时刻（可保留）
4-5分：情绪平淡（可删除）
1-3分：无情绪波动（必须删除）
\`\`\`

**B. 提取公式**
\`\`\`
每${batchSize}章小说 → 识别3-8个情绪钩子（10-6分）

高密度：${batchSize}章有 6-8个高强度钩子
中密度：${batchSize}章有 3-5个高强度钩子
低密度：${batchSize}章有 1-2个高强度钩子
\`\`\`

**C. 钩子识别清单**
\`\`\`markdown
## 情绪钩子提取清单（第X-X章）

### 高强度钩子（10-8分）
1. **钩子描述**：[...]
   - 位置：第X章
   - 情绪类型：[爽感/虐心/悬疑/紧张/温情/反差]
   - 强度评分：[X/10]
   - 涉及角色：[...]
   - 改编策略：[单独成集/核心爽点]

2. **钩子描述**：[...]
   - ...

### 中强度钩子（7-6分）
1. **钩子描述**：[...]
   - 改编策略：[可保留/可合并]

### 钩子密度
- 高强度钩子：[X个]
- 中强度钩子：[X个]
- 平均密度：[每X章一个高强度钩子]
\`\`\`

---

## 三、剧情拆解与分集标注

### 拆解核心逻辑

**任务**：从每${batchSize}章小说中拆解出剧情点，并直接标注分集

**核心原则**：
- 拆解时就决定保留/删除
- 不需要的剧情直接不输出
- 拆解时就标注分集（第X集）
- 确保每集500-800字，1-3个剧情点

---

### 剧情点描述公式（方案A）

**统一格式**：
\`\`\`
【剧情n】[场景]，[角色A]对[角色B][做了什么]，[情绪钩子类型]，第X集,第x章
\`\`\`

**公式要素**：
- **场景**：剧情发生的地点/环境
- **角色A**：动作发起者（主角/配角）
- **角色B**：动作对象（可选）
- **做了什么**：核心事件/动作
- **情绪钩子类型**：打脸蓄力、碾压爽点、金手指觉醒、虐心痛点、真相揭露等
- **第X集**：分配到哪一集
- **第X章**：该剧情来源小说哪一章节

**示例**：
\`\`\`
【剧情1】宗门大殿，未婚妻云烟对叶凡当众撕毁婚约并羞辱，打脸蓄力，第1集，第001章
【剧情2】回住处，叶凡独自觉醒签到系统并获得神级功法，金手指觉醒，第1集，第001章
【剧情3】神文课堂，叶凡写"火"字威力超过讲师十倍，初露锋芒，第2集，第001章
【剧情4】演武场月度考核，叶凡越级秒杀识文境九层云逸，碾压爽点，第3集，第002章
【剧情5】宗门密室，院长墨渊对叶凡破格提拔为核心弟子，身份提升，第3集，第002章
【剧情6】闭关修炼，叶凡境界从识文境五层突破到悟文境，实力突破，第4集，第003章
\`\`\`

**情绪钩子类型参考**：
- 打脸蓄力、打脸爽点、碾压爽点
- 金手指觉醒、实力突破、身份曝光
- 虐心痛点、误会产生、真相揭露
- 危机出现、绝境反杀、底牌爆发
- 先知优势（重生类）、复仇成功

---

### 拆解与分集步骤

**第一步：批量阅读${batchSize}章**
- 快速识别所有剧情点
- 标注情绪强度（1-10分）
- 筛选保留/删除

**第二步：提取保留的剧情点**
- 只输出需要保留的剧情
- 使用统一公式描述
- 按顺序编号【剧情1】【剧情2】...

**第三步：分集标注**
- 判断几个剧情点合并成一集
- 标准：每集500-800字，1-3个剧情点
- 标注：第X集
- 标注：第X章

**第四步：输出剧情清单**
\`\`\`
【剧情1】[场景]，[角色]对[角色][做了什么]，[情绪类型]，第1集，第001章
【剧情2】[场景]，[角色]对[角色][做了什么]，[情绪类型]，第1集，第001章
【剧情3】[场景]，[角色]对[角色][做了什么]，[情绪类型]，第2集，第001章
...
\`\`\`

---

### 分集判断标准

**每集包含剧情点数量**：

| 剧情点特征 | 每集数量 | 总字数估算 |
|-----------|---------|-----------|
| **高强度钩子**（10-9分） | 1个 | 600-800字 |
| **中强度钩子**（8-7分） | 1-2个 | 500-700字 |
| **低强度钩子**（6分） | 2-3个 | 500-600字 |

**分集原则**：
- 高潮时刻单独成集（如打脸、碾压、身份曝光）
- 过渡剧情合并成集（如修炼过程、赶路）
- 确保每集有明确的起承转钩结构

**分集示例**：
\`\`\`
第1集（2个剧情点）：
【剧情1】被退婚羞辱，打脸蓄力
【剧情2】觉醒签到系统，金手指觉醒

第2集（1个剧情点）：
【剧情3】神文课堂大放异彩，初露锋芒

第3集（2个剧情点）：
【剧情4】月度考核越级秒杀，碾压爽点
【剧情5】被破格提拔核心弟子，身份提升
\`\`\`

---

### 压缩策略（通用）

**策略1：冲突合并法**
\`\`\`
小说：章1冲突A + 章2过渡 + 章3冲突B + 章4过渡 + 章5冲突C
                    ↓
漫剧：第N集（冲突A+B+C合并，删除过渡）

原则：
- 删除所有过渡章节
- 保留冲突和爽点
- 合并同类型冲突
\`\`\`

**策略2：时间跳跃法**
\`\`\`
小说：5章修炼过程详细描写
                    ↓
漫剧：【蒙太奇】10秒展示 + 【文字】"三天后"

原则：
- 删除过程描写
- 只保留结果展示
- 用特效和文字说明时间跨度
\`\`\`

**策略3：信息前置法**
\`\`\`
小说：章1-5铺垫 → 章6爆发
                    ↓
漫剧：第N集直接爆发 → 用【闪回】补充背景

原则：
- 爽点前置，先爽再解释
- 用闪回/对话补充信息
- 不要慢节奏铺垫
\`\`\`

**策略4：删繁就简法**
\`\`\`
必删内容：
❌ 环境描写（山川风景、房间布置）
❌ 心理独白（长篇内心戏）
❌ 过渡情节（赶路、日常、闲聊）
❌ 支线剧情（与主线无关）
❌ 重复内容（相似情节只保留最精彩的）

必留内容：
✅ 冲突对话
✅ 动作场景
✅ 情绪爆点
✅ 悬念设置
✅ 关系展示
\`\`\`

**策略5：支线取舍法**
\`\`\`
原则：
- 主线：完整保留（80%篇幅）
- 重要支线：精简保留（15%篇幅）
- 次要支线：极度压缩（5%篇幅）
- 无关支线：完全删除

判断标准：
- 主线：直接关系主角成长和终极目标
- 重要支线：影响主线发展的关键人物线
- 次要支线：丰富世界观但可有可无
- 无关支线：删除不影响理解
\`\`\`

---

## 四、人物体系整理

### 从小说提取人物

**任务**：从小说中提取所有角色，分类整理

**人物分类**：

| 类别 | 定义 | 改编策略 |
|------|------|---------|
| **主角** | 第一主角 | 完整保留 |
| **主要配角** | 对主线有重要影响的角色（3-5人） | 保留，适度简化 |
| **次要配角** | 有一定戏份但非核心的角色（5-10人） | 精简保留或合并 |
| **炮灰工具人** | 推动情节的龙套（无数） | 极度简化，同类型合并 |
| **最终对手** | 终极boss | 完整保留 |

---

### 人物简化原则

**原则1：工具人化**
\`\`\`
小说：每个配角都有详细背景和性格
                    ↓
漫剧：配角只保留功能性，删除背景故事

示例：
小说中的"长老A"有完整人生经历
漫剧中只需要"见证主角强大的长老"
\`\`\`

**原则2：角色合并**
\`\`\`
小说：三个反派分别在不同章节出现
                    ↓
漫剧：合并为一个反派，或者分批次使用

合并条件：
- 功能相似
- 不影响理解
- 可以合并台词和冲突
\`\`\`

**原则3：关系简化**
\`\`\`
小说：复杂的人物关系网
                    ↓
漫剧：只保留核心关系

保留：
✓ 主角vs主要对手
✓ 主角与重要配角的关系
✓ 直接影响剧情的关系

删除：
❌ 次要人物之间的关系
❌ 复杂的家族关系网
❌ 不影响主线的人物线
\`\`\`

---

### 人物改编清单

**标准人物清单模板**：
\`\`\`markdown
## 人物清单（改编版）

### 主角
**姓名**：[...]
- 小说中的身份：[...]
- 改编后的身份：[...]（简化版）
- 核心特征：[2-3个标签]
- 金手指/能力：[...]
- 主要关系：[vs谁]

### 主要配角（3-5人）
**姓名**：[...]
- 功能定位：[打脸对象/权威见证/成长助力/最终对手]
- 核心特征：[1-2个标签]
- 与主角关系：[...]
- 保留原因：[...]

### 炮灰工具人（分批）
**类型**：[第X-X集反派/长老/围观者]
- 功能：[被打脸/见证/推动剧情]
- 简化策略：[合并同类型/极简描述]

### 删除角色清单
- [角色名]：删除原因 - [与主线无关/戏份太少/可合并]
\`\`\`

---


## 五、付费转化设计

### 付费节点布局

**核心理念**：
- 付费点 = 第20集结尾 = 情绪最高潮 + 悬念最顶点
- 必须让观众"不看下集会死"
- 绝不是故事自然结束

**标准付费节点**：
\`\`\`
免费段：第1-20集
第20集结尾：卡最强悬念（免费段的最后一集）

付费后：全部解锁
\`\`\`

---

### 第20集大爆点设计

**要求**：免费段的最后一集，必须让观众欲罢不能

**设计方法**：
1. 从小说中找到前期最强的冲突高潮
2. 卡在即将爆发的时刻
3. 可以是：即将战斗/即将身份曝光/即将真相揭露

**示例**：
\`\`\`
【画面】主角vs强敌，激战正酣
【对白】"就让你见识一下，我真正的实力！"
【特写】主角眼神一变，气势爆发
【卡黑】
\`\`\`

**关键**：
- 第20集前的剧情要为此蓄力
- 爆点要足够震撼
- 悬念要吊足胃口

---

## 六、类型特殊要点

${getGenreStrategy(genre)}

---

## 七、改编禁忌与原则

### 致命错误（导致失败）

**❌ 错误1：过度忠于原著**
\`\`\`
问题：试图保留小说所有内容，导致节奏拖沓
结果：观众流失，付费率低

正确做法：
✓ 大胆删减，只保留核心冲突和爽点
✓ 不要有"舍不得删"的心态
\`\`\`

**❌ 错误2：节奏过慢**
\`\`\`
问题：保留了小说的铺垫和过渡
结果：观众3秒就滑走了

正确做法：
✓ 3秒进冲突，瞬间抓眼球
✓ 删除所有铺垫和过渡
✓ 爽点前置，先爽再解释
\`\`\`

**❌ 错误3：心理描写过多**
\`\`\`
问题：保留了小说的心理独白和内心戏
结果：画面无法展现，观众看不懂

正确做法：
✓ 心理→动作（用动作展现情绪）
✓ 心理→对话（用对话说出心声）
✓ 心理→删除（不重要的直接删）
\`\`\`

**❌ 错误4：支线过多**
\`\`\`
问题：试图保留所有支线剧情
结果：主线模糊，观众不知道在看什么

正确做法：
✓ 只保留主线（80%）
✓ 重要支线精简保留（15%）
✓ 其他支线全部删除（5%）
\`\`\`

**❌ 错误5：人物过多**
\`\`\`
问题：保留了小说中的所有角色
结果：观众记不住，人物混乱

正确做法：
✓ 主角+主要配角（5-8人）
✓ 炮灰工具人合并同类型
✓ 无关角色完全删除
\`\`\`

---

### 改编核心原则（必须遵守）

**✅ 原则1：情绪钩子优先**
\`\`\`
选择标准：
- 有爽点的内容 > 完整的故事
- 能让观众"卧槽"的情节 > 逻辑严密的情节
- 情绪刺激强度 > 文学性

实施方法：
- 从小说中识别所有高强度情绪钩子
- 优先保留10-8分的钩子
- 围绕钩子重构故事
\`\`\`

**✅ 原则2：视觉化优先**
\`\`\`
转换标准：
- 能拍成画面的 > 抽象的描写
- 动作场景 > 心理描写
- 对话冲突 > 内心独白

实施方法：
- 所有内容必须可视化
- 用※△【】标注场景/动作/特效
- 删除无法转化为画面的内容
\`\`\`

**✅ 原则3：快节奏强制**
\`\`\`
节奏要求：
- 3秒进冲突
- 每30秒必有推进
- 每集必有悬念【卡黑】
- 全程无尿点

实施方法：
- 删除所有铺垫和过渡
- 场景快速切换
- 用蒙太奇压缩时间
\`\`\`

**✅ 原则4：尊重原作结构**
\`\`\`
设计逻辑：
- 保持小说原有故事结构
- 不强行重构三幕式
- 集数根据内容自然生成
- 单集确保起承转钩结构

实施方法：
- 按小说顺序拆解剧情
- 拆解时直接标注分集
- 不提前设定目标集数
\`\`\`

**✅ 原则5：算法友好**
\`\`\`
优化目标：
- 完播率：每集结尾强悬念
- 互动率：设置争议点/吐槽点
- 传播率：金句台词可截图

实施方法：
- 每集必须【卡黑】
- 人物性格/台词要有争议性
- 台词简短、霸气、可传播
\`\`\`

---

## 总结：改编成功的关键

**改编 ≠ 翻译**：
- 不是把小说文字转成剧本文字
- 而是提取情绪钩子，重构叙事节奏

**核心公式**：
\`\`\`
成功改编 = 情绪钩子提取 × 冲突密度压缩 × 视觉语言转化 × 节奏强制重构
\`\`\`

**三大法则**：
1. 情绪钩子密度 > 故事完整性
2. 尊重原作结构 > 强行重构三幕
3. 算法友好性 > 戏剧逻辑性

`
