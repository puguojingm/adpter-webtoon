import { NovelType } from './types';


// Knowledge Base Constants
/**
 * 类型策略映射
 * 合并规则：
 * - 玄幻 + 武侠 → 玄幻/武侠类型
 * - 言情 + 古言 → 言情/古言类型
 * - 悬疑 + 推理 → 悬疑/推理类型
 * - 科幻 + 末世 → 科幻/末世类型
 * - 都市 → 都市/现代类型
 * - 重生 → 重生类型
 */
// 玄幻/武侠类型策略
const FANTASY_WUXIA_STRATEGY = `### 玄幻/武侠类型
**特殊要点**：
- 境界体系要清晰可视化（用系统面板展示）
- 战力数值要明确
- 打脸节奏要密集（每2-3集）
- 金手指规则要简单易懂
**改编重点**：
\`\`\`
必保留：
✓ 境界突破场景
✓ 打脸羞辱场景
✓ 越级挑战场景
✓ 身份曝光场景
✓ 宝物争夺场景
必删除：
❌ 修炼过程详细描写
❌ 功法原理解释
❌ 环境风景描写
❌ 赶路过渡
必强化：
⚡ 数值展示（境界/战力可视化）
⚡ 力量对比（用特效展现）
⚡ 打脸反应（围观者震惊）
\`\`\`
**压缩策略**：
- 修炼过程：用【蒙太奇】10秒展示
- 战斗过程：保留关键招式，删除回合描写
- 突破过程：用特效+数值展示`;
// 都市/现代类型策略
const URBAN_STRATEGY = `### 都市/现代类型
**特殊要点**：
- 现代社会规则要合理
- 身份对比要现实化
- 打脸方式多样化（财富/地位/能力）
- 场景贴近生活
**改编重点**：
\`\`\`
必保留：
✓ 身份反差场景（豪门vs屌丝）
✓ 财富对比场景（贫富差距）
✓ 地位碾压场景（身份揭露）
✓ 真相大白场景（误会解除）
✓ 商战对决场景
必删除：
❌ 日常生活琐事
❌ 工作细节描写
❌ 心理独白
❌ 城市风景描写
必强化：
⚡ 对话冲突（语言交锋）
⚡ 身份反转（视觉冲击）
⚡ 打脸时刻（众人反应）
\`\`\`
**压缩策略**：
- 商战过程：只保留关键决策和结果
- 调查过程：用【蒙太奇】快速展示
- 日常过渡：完全删除`;
// 言情/古言类型策略
const ROMANCE_STRATEGY = `### 言情/古言类型
**特殊要点**：
- 误会要合理化
- 虐点要精准狠辣
- 宠溺要甜到极致
- 情感张力要强
**改编重点**：
\`\`\`
必保留：
✓ 误会产生场景
✓ 虐心痛苦场景
✓ 真相大白场景
✓ 甜宠片段
✓ 吃醋争风场景
必删除：
❌ 心理独白（过度的）
❌ 日常甜蜜（重复的）
❌ 环境描写
❌ 无关支线
必强化：
⚡ 情感冲突（对话/表情）
⚡ 误会解除（反转时刻）
⚡ 虐心时刻（泪点）
⚡ 反差对比（虐转甜）
\`\`\`
**压缩策略**：
- 心理活动：转为对话或动作
- 日常甜蜜：只保留最甜的片段
- 误会铺垫：快速进入，不拖沓`;
// 悬疑/推理类型策略
const SUSPENSE_MYSTERY_STRATEGY = `### 悬疑/推理类型
**特殊要点**：
- 线索要清晰
- 反转要合理且震撼
- 节奏要紧张
- 真相要出人意料
**改编重点**：
\`\`\`
必保留：
✓ 关键线索发现
✓ 反转时刻
✓ 真相揭露场景
✓ 紧张追逐场景
✓ 凶手曝光场景
必删除：
❌ 推理过程（过度详细的）
❌ 细节描写
❌ 日常调查琐事
必强化：
⚡ 悬念设置
⚡ 反转冲击
⚡ 紧张氛围
⚡ 时间压力
\`\`\`
**压缩策略**：
- 推理过程：只保留关键线索和结论
- 调查细节：用【蒙太奇】快速展示
- 铺垫时间：大幅压缩`;
// 科幻/末世类型策略
const SCIFI_DOOMSDAY_STRATEGY = `### 科幻/末世类型
**特殊要点**：
- 世界观要快速建立
- 危机要持续紧张
- 觉醒/升级要震撼
- 黑科技要简单易懂
**改编重点**：
\`\`\`
必保留：
✓ 危机爆发场景
✓ 异能觉醒场景
✓ 黑科技展示
✓ 基地争夺
✓ 丧尸/怪物对抗
必删除：
❌ 世界观详细铺垫
❌ 科学原理解释
❌ 环境描写
❌ 日常求生琐事
必强化：
⚡ 视觉特效（异能/科技）
⚡ 紧张节奏（危机持续）
⚡ 危机升级（不断加强）
\`\`\`
**压缩策略**：
- 世界观建立：用【文字】+对话快速说明
- 科技原理：不解释，直接展示效果
- 求生过程：只保留关键冲突`;
// 重生类型策略
const REBIRTH_STRATEGY = `### 重生类型
**特殊要点**：
- 前世今生对比要强烈
- 先知优势要爽快利用
- 复仇节奏要密集
- 布局感要强（步步为营）
- 前世遗憾要逐一弥补
**核心爽点**：
- 先知剧情（"我早就知道"）
- 改变命运（避开危险/夺取机缘）
- 打脸仇敌（前世欺负我的人）
- 提前布局（"等你入套"）
- 实力碾压（重生后快速崛起）
- 身份反转（废材→天才）
**改编重点**：
\`\`\`
必保留：
✓ 重生回归场景（第1集核心）
✓ 前世记忆闪回（关键节点）
✓ 先知优势利用（夺取机缘/避开危险）
✓ 打脸前世仇敌场景
✓ 布局复仇场景（步步为营）
✓ 提前预判场景（"我早知道"）
✓ 改变命运关键节点
✓ 前世今生对比场景
必删除：
❌ 前世详细回忆（过长的）
❌ 重生原理解释
❌ 过度的内心纠结
❌ 重复的先知展示
❌ 无关的前世支线
必强化：
⚡ 前世今生对比（用【闪回】+对比画面）
⚡ 先知优势（"这次我知道..."）
⚡ 布局感（"三步计划"）
⚡ 打脸时刻（"你前世欺负我..."）
⚡ 提前预判（"果然和我想的一样"）
⚡ 命运改变（"这次不一样了"）
\`\`\`
**重生题材特有处理**：
**1. 重生开场（第1集）**
\`\`\`
标准开场结构：
【起】前世死亡/绝望场景（15秒）
  → 【闪回】前世被背叛/被害经过（快速）
【承】猛然惊醒，发现重生（10秒）
  → 确认时间/地点/身份
【转】决心改变命运（15秒）
  → 【独白】"这次，我要让你们付出代价"
【钩】即将发生的第一个改变（10秒）
  → 【卡黑】
禁止：
❌ 慢节奏的前世回忆
❌ 详细解释重生原理
❌ 过长的情绪酝酿
正确做法：
✅ 瞬间进入前世死亡场景
✅ 快速确认重生事实
✅ 立即展示先知优势
\`\`\`
**2. 前世记忆的使用**
\`\`\`
原则：
- 不要大段回忆，用【闪回】碎片化展示
- 只在关键节点闪回（打脸/复仇/改变命运时）
- 前世画面用灰色/暗色调区分
使用时机：
✓ 遇到前世仇敌时 → 闪回被害场景（5秒）
✓ 夺取机缘时 → 闪回前世错失场景（3秒）
✓ 避开危机时 → 闪回前世中招场景（3秒）
✓ 打脸时 → 闪回前世被羞辱场景（5秒）
禁止：
❌ 单独一集全是前世回忆
❌ 重复闪回同一场景
❌ 闪回超过10秒
\`\`\`
**3. 先知优势的展示**
\`\`\`
展示方法：
【方法1】提前预判
△ 主角："三天后会发生XX"
△ 配角："你怎么知道？"
△ 主角冷笑："等着看吧"
【三天后】果然发生，众人震惊
【方法2】提前布局
△ 主角暗中做准备
△ 众人不理解
△ 危机来临，主角早有准备
△ 众人震惊："你早就知道？！"
【方法3】改变剧情
△ 【闪回】前世：主角错失机缘/被害
△ 【现在】主角提前抢夺/避开危险
△ 仇敌傻眼："怎么不一样了？！"
强化台词：
✓ "我早就知道了"
✓ "这次，结局会不一样"
✓ "你前世做的事，我都记得"
✓ "让你看看，改变命运的代价"
✓ "这次换我碾压你了"
\`\`\`
**4. 复仇节奏控制**
\`\`\`
复仇对象分层：
- 小喽啰（前期）：快速打脸，建立爽点
- 主要仇敌（中期）：步步为营，逐个击破
- 幕后黑手（后期）：终极复仇
复仇方式：
✓ 夺取他的机缘
✓ 揭穿他的阴谋
✓ 让他众叛亲离
✓ 碾压他的实力
✓ 让他跪地求饶
✓ 让他体验前世我的痛苦
节奏要求：
- 每5集至少打脸1个前世仇敌
- 每20集彻底击败1个主要仇敌
\`\`\`
**5. 改变命运的关键节点**
\`\`\`
标准处理：
【前世】（闪回5秒）
△ 灰色画面：前世主角的失败/痛苦
△ 【文字】"前世，我在这里失去了一切"
【今生】（现在30秒）  
△ 彩色画面：今生主角的布局/行动
△ 主角："这次，不会再犯同样的错误"
△ 结果：成功改变，获得机缘/避开危险
△ 【独白】"命运，从此改写"
关键节点：
✓ 第一次改变：避开前世第一个危机
✓ 第二次改变：夺取前世错失的重要机缘
✓ 第三次改变：救下前世死去的重要人物
✓ 终极改变：彻底改写前世悲剧
\`\`\`
**压缩策略**：
- 前世回忆：用【闪回】3-5秒快速展示，不单独成集
- 重生原理：不解释，用【文字】一句话说明"重生归来"即可
- 布局过程：只保留关键步骤，用【蒙太奇】展示准备
- 复仇铺垫：删除过长铺垫，直接进入打脸高潮
- 先知优势：不要重复展示，每种展示方式用1-2次即可
**重生题材禁忌**：
\`\`\`
❌ 前世回忆过多（超过总篇幅10%）
❌ 重生原理解释（浪费时间）
❌ 过度纠结前世（快速进入今生改变）
❌ 先知优势滥用（失去紧张感）
❌ 复仇拖沓（要快速打脸）
❌ 改变命运太容易（要有挑战）
✅ 前世闪回碎片化（每次3-5秒）
✅ 重生事实快速确认（第1集完成）
✅ 立即展示改变（第2-3集就要有第一个改变）
✅ 先知优势精准使用（关键时刻）
✅ 复仇节奏密集（每5集打脸）
✅ 保留挑战感（不是无敌，仍需努力）
\`\`\`
**重生题材爽点密度**：
\`\`\`
每集必有：
- 先知优势展示 或
- 打脸前世仇敌 或  
- 改变前世命运 或
- 布局复仇计划
每5集必有：
- 一次重要的命运改变
- 一个前世仇敌被打脸
每20集必有：
- 一个主要仇敌被击败
- 一个重大遗憾被弥补
- 一个关键机缘被夺取
\`\`\`
**重生题材台词模板**：
\`\`\`
经典台词：
✓ "前世，你害我至此。今生，该你偿还了"
✓ "我早就知道你的打算，可惜，这次我不会上当"
✓ "前世我输了，因为我不知道。这次，我知道一切"
✓ "你以为你赢了？不，游戏才刚刚开始"
✓ "前世你踩着我的尸体往上爬，今生该换换了"
✓ "谢谢你前世教会我，这个世界有多残酷"
✓ "这次，让你尝尝我前世的痛苦"
\`\`\`
**重生题材开场示例**：
\`\`\`
※ 前世，悬崖边
【特效】画面灰暗，血色天空
△ 主角被数人围攻，身负重伤
△ 前方，未婚妻和好兄弟并肩而立，眼神冷漠
△ 未婚妻："你以为你是谁？配不上我"
△ 好兄弟："对不起，是我告密的，你的功法我也要了"
△ 主角被一掌击飞，坠落万丈深渊
【独白】"如果能重来...我一定..."
---
※ 今生，卧室
△ 主角猛然惊醒，大口喘气
△ 环顾四周，熟悉的房间
△ 看向镜子，年轻的面容
【文字】三年前
△ 主角拳头紧握，眼神冰冷
【独白】我...重生了
△ 门外传来敲门声，未婚妻的声音："还在睡吗？"
△ 主角嘴角勾起一抹冷笑
【独白】这次，让你们付出代价
【卡黑】
\`\`\``;


export const GENRE_STRATEGIES: Record<NovelType, string> = {
  // 玄幻/武侠 - 共用策略
  [NovelType.FANTASY]: FANTASY_WUXIA_STRATEGY,
  [NovelType.WUXIA]: FANTASY_WUXIA_STRATEGY,
  
  // 都市/现代
  [NovelType.URBAN]: URBAN_STRATEGY,
  
  // 言情/古言 - 共用策略
  [NovelType.ROMANCE]: ROMANCE_STRATEGY,
  [NovelType.ANCIENT_ROMANCE]: ROMANCE_STRATEGY,
  
  // 悬疑/推理 - 共用策略
  [NovelType.SUSPENSE]: SUSPENSE_MYSTERY_STRATEGY,
  [NovelType.MYSTERY]: SUSPENSE_MYSTERY_STRATEGY,
  
  // 科幻/末世 - 共用策略
  [NovelType.SCI_FI]: SCIFI_DOOMSDAY_STRATEGY,
  [NovelType.DOOMSDAY]: SCIFI_DOOMSDAY_STRATEGY,
  
  // 重生
  [NovelType.REBIRTH]: REBIRTH_STRATEGY,
};

export const getGenreStrategy = (genre: NovelType): string => {
  return GENRE_STRATEGIES[genre] ?? '';
};



export const getBreakPlotMethod = (batchSize: number, genre: NovelType) => `
---
name: break-plot-method
description: 网文改编漫剧剧情拆解方法论、适用于60万-300万字长篇小说改编为动态漫剧，包含冲突提取、情绪钩子识别、剧情拆解、分集标注、节奏控制等全流程指导
---

# 总则
## 总体取向

**改编的本质**：不是"翻译"，而是"重构"

网文改编漫剧的核心是**提取情绪钩子、压缩冲突密度、转化视觉语言、重构叙事节奏**。

**核心原则**：
- 情绪钩子密度 > 故事完整性
- 视觉冲击力 > 文学性描写
- 快节奏刺激 > 慢节奏沉浸
- 算法友好性 > 戏剧逻辑性

**改编对象**：
- **小说类型**：玄幻、武侠、都市、言情、古言、悬疑、推理、科幻、末世、重生等所有类型
- **小说长度**：60万-300万字长篇网文
- **目标产品**：动态集数漫剧（每集1-2分钟，集数根据内容自然生成）

**漫剧基本规格**：
- **每集时长**：1-2分钟
- **每集字数**：500-800字
- **集数**：根据小说内容自然生成（不提前设定）

---

## 整体改编公式
\`\`\`
网文改编漫剧 = 情绪钩子提取 + 冲突密度压缩 + 视觉语言转化 + 节奏强制重构
\`\`\`

**叙事结构**：
- **季弧（整体）**：保持小说原有故事结构，不强行重构
- **集内（单集）**：采用起承转钩四段式（起-开场冲突、承-推进发展、转-反转高潮、钩-悬念结尾）

**改编思维转换**：

| 维度 | 原创思维 | 改编思维 |
|------|---------|---------|
| **起点** | 从零构思故事 | 从已有小说提取精华 |
| **目标** | 讲好一个故事 | 提取最爽的情绪钩子 |
| **结构** | 自由设计 | 尊重小说原有结构，不强行重构 |
| **人物** | 自由创造 | 从小说提取，需简化 |
| **节奏** | 自由把控 | 需大幅压缩，删繁就简 |
| **集数** | 自由确定 | 根据内容密度自然生成 |

# 剧情拆解方法论

## 一、冲突点识别与提取

### 冲突点定义

**什么是冲突点**：
- 推动情节发展的关键事件
- 让观众产生情绪波动的时刻
- 角色之间的对立和碰撞
- 主角面临的挑战和危机

**冲突点 ≠ 情节点**：
- 情节点：所有发生的事件（包括过渡、铺垫、日常）
- 冲突点：有张力、有对立、有情绪的事件

---

### 冲突点识别方法

**识别标准**：

**A. 强度分级**

| 等级 | 定义 | 特征 | 改编策略 |
|------|------|------|---------|
| **⭐⭐⭐ 核心冲突** | 推动主线的关键事件 | 改变主角命运、大幅改变格局 | 必须保留，独立成集 |
| **⭐⭐ 次级冲突** | 推动支线或铺垫的事件 | 推进剧情但非关键转折 | 选择性保留，可合并 |
| **⭐ 过渡冲突** | 日常、铺垫、环境描写 | 无明显对立和张力 | 删除或极度压缩 |

**B. 类型识别**（跨类型通用）

| 冲突类型 | 定义 | 示例 |
|---------|------|------|
| **人物对立** | 角色之间的直接冲突 | 主角vs反派、误会、背叛 |
| **力量对比** | 实力差距引发的冲突 | 越级挑战、碾压、觉醒 |
| **身份矛盾** | 身份差异引发的冲突 | 贵贱对立、隐藏身份、真相揭露 |
| **情感纠葛** | 情感关系引发的冲突 | 误会、背叛、虐恋、三角恋 |
| **生存危机** | 生死存亡的冲突 | 追杀、危机、末世、绝境 |
| **真相悬念** | 谜团引发的冲突 | 凶手是谁、幕后黑手、身世之谜 |

---

### 冲突点提取策略

**提取步骤**：

**第一步：批量阅读**
- 每次阅读${batchSize}章（约12000-24000字）
- 快速识别所有冲突点
- 标注冲突类型和强度

**第二步：筛选分级**
- ⭐⭐⭐ 核心冲突：标记为"必保留"
- ⭐⭐ 次级冲突：标记为"可保留"
- ⭐ 过渡冲突：标记为"删除"

**第三步：密度统计**
\`\`\`
冲突密度 = ${batchSize}章内的核心冲突数量

高密度：${batchSize}章内有 5个以上核心冲突
中密度：${batchSize}章内有 2-4个核心冲突  
低密度：${batchSize}章内有 0-1个核心冲突
\`\`\`

**第四步：改编策略**
- 高密度：保留大部分冲突，适度合并
- 中密度：保留核心冲突，删除次级冲突
- 低密度：只保留核心冲突，大量压缩

---

### 冲突点识别模板

**标准识别清单**（每${batchSize}章填写）：
\`\`\`markdown
## 第[X-X]章 冲突点识别清单

### 核心冲突（⭐⭐⭐）
1. **冲突描述**：[...]
   - 位置：第X章
   - 类型：[人物对立/力量对比/身份矛盾/情感纠葛/生存危机/真相悬念]
   - 涉及角色：[主角vs谁]
   - 情绪强度：[1-10分]
   - 改编价值：[高/中/低]

2. **冲突描述**：[...]
   - ...

### 次级冲突（⭐⭐）
1. **冲突描述**：[...]
   - ...

### 冲突密度评估
- 核心冲突数量：[X个]
- 密度评级：[高/中/低]
- 压缩策略：[...]
\`\`\`

---

## 二、情绪钩子提取与标注

### 情绪钩子定义

**什么是情绪钩子**：
- 能让观众产生强烈情绪反应的情节点
- 让观众"卧槽/爽/哭/笑/急"的时刻
- 短视频中让观众停留的"钩子"

**情绪钩子 vs 冲突点**：
- 冲突点：所有有对立的事件
- 情绪钩子：冲突点中最能引发情绪的高潮时刻

---

### 情绪钩子类型（跨类型通用）

**通用情绪钩子清单**：

| 情绪类型 | 钩子示例 | 适用类型 |
|---------|---------|---------|
| **爽感钩子** | 打脸、碾压、装X、反杀、复仇成功 | 玄幻、都市、武侠、重生 |
| **虐心钩子** | 误会、背叛、生离死别、痛苦抉择 | 言情、古言 |
| **悬疑钩子** | 真相揭露、身份曝光、反转、揭秘 | 悬疑、推理 |
| **紧张钩子** | 危机、追杀、死亡威胁、倒计时 | 科幻、末世、动作 |
| **温情钩子** | 守护、牺牲、感动、团圆 | 所有类型 |
| **反差钩子** | 身份反转、实力曝光、扮猪吃虎 | 所有类型 |

**不同类型的专属钩子**：

**玄幻/武侠**：
- 境界突破、越级碾压、身份曝光、血脉觉醒
- 打脸羞辱、宗门大比、秘境奇遇、宝物争夺

**都市/现代**：
- 身份揭露、财富对比、地位碾压、真相大白
- 前妻后悔、商战对决、阴谋揭穿、豪门恩怨

**言情/古言**：
- 误会解除、虐恋虐心、真心表白、强制爱
- 破镜重圆、宠溺反差、吃醋争风、生离死别

**悬疑/推理**：
- 凶手曝光、真相反转、证据发现、关键线索
- 危机时刻、死亡威胁、时间倒计时、最后一搏

**科幻/末世**：
- 异能觉醒、丧尸危机、基地争夺、黑科技展示
- 人性考验、背叛求生、团队对抗、终极一战

**重生复仇**：
- 先知剧情、改变命运、打脸前世仇敌、提前布局
- 夺取机缘、避开危险、身份反转、复仇成功

---

### 情绪钩子提取方法

**提取标准**：

**A. 情绪强度评分**（1-10分）
\`\`\`
10分：让观众"卧槽！"的时刻（必须单独成集）
8-9分：让观众爽/虐/急的高潮（核心爽点）
6-7分：让观众有感觉的时刻（可保留）
4-5分：情绪平淡（可删除）
1-3分：无情绪波动（必须删除）
\`\`\`

**B. 提取公式**
\`\`\`
每${batchSize}章小说 → 识别3-8个情绪钩子（10-6分）

高密度：${batchSize}章有 6-8个高强度钩子
中密度：${batchSize}章有 3-5个高强度钩子
低密度：${batchSize}章有 1-2个高强度钩子
\`\`\`

**C. 钩子识别清单**
\`\`\`markdown
## 情绪钩子提取清单（第X-X章）

### 高强度钩子（10-8分）
1. **钩子描述**：[...]
   - 位置：第X章
   - 情绪类型：[爽感/虐心/悬疑/紧张/温情/反差]
   - 强度评分：[X/10]
   - 涉及角色：[...]
   - 改编策略：[单独成集/核心爽点]

2. **钩子描述**：[...]
   - ...

### 中强度钩子（7-6分）
1. **钩子描述**：[...]
   - 改编策略：[可保留/可合并]

### 钩子密度
- 高强度钩子：[X个]
- 中强度钩子：[X个]
- 平均密度：[每X章一个高强度钩子]
\`\`\`

---

## 三、剧情拆解与分集标注

### 拆解核心逻辑

**任务**：从每${batchSize}章小说中拆解出剧情点，并直接标注分集

**核心原则**：
- 拆解时就决定保留/删除
- 不需要的剧情直接不输出
- 拆解时就标注分集（第X集）
- 确保每集500-800字，1-3个剧情点

---

### 剧情点描述公式（方案A）

**统一格式**：
\`\`\`
【剧情n】[场景]，[角色A]对[角色B][做了什么]，[情绪钩子类型]，第X集,第x章
\`\`\`

**公式要素**：
- **场景**：剧情发生的地点/环境
- **角色A**：动作发起者（主角/配角）
- **角色B**：动作对象（可选）
- **做了什么**：核心事件/动作
- **情绪钩子类型**：打脸蓄力、碾压爽点、金手指觉醒、虐心痛点、真相揭露等
- **第X集**：分配到哪一集
- **第X章**：该剧情来源小说哪一章节

**示例**：
\`\`\`
【剧情1】宗门大殿，未婚妻云烟对叶凡当众撕毁婚约并羞辱，打脸蓄力，第1集，第001章
【剧情2】回住处，叶凡独自觉醒签到系统并获得神级功法，金手指觉醒，第1集，第001章
【剧情3】神文课堂，叶凡写"火"字威力超过讲师十倍，初露锋芒，第2集，第001章
【剧情4】演武场月度考核，叶凡越级秒杀识文境九层云逸，碾压爽点，第3集，第002章
【剧情5】宗门密室，院长墨渊对叶凡破格提拔为核心弟子，身份提升，第3集，第002章
【剧情6】闭关修炼，叶凡境界从识文境五层突破到悟文境，实力突破，第4集，第003章
\`\`\`

**情绪钩子类型参考**：
- 打脸蓄力、打脸爽点、碾压爽点
- 金手指觉醒、实力突破、身份曝光
- 虐心痛点、误会产生、真相揭露
- 危机出现、绝境反杀、底牌爆发
- 先知优势（重生类）、复仇成功

---

### 拆解与分集步骤

**第一步：批量阅读${batchSize}章**
- 快速识别所有剧情点
- 标注情绪强度（1-10分）
- 筛选保留/删除

**第二步：提取保留的剧情点**
- 只输出需要保留的剧情
- 使用统一公式描述
- 按顺序编号【剧情1】【剧情2】...

**第三步：分集标注**
- 判断几个剧情点合并成一集
- 标准：每集500-800字，1-3个剧情点
- 标注：第X集
- 标注：第X章

**第四步：输出剧情清单**
\`\`\`
【剧情1】[场景]，[角色]对[角色][做了什么]，[情绪类型]，第1集，第001章
【剧情2】[场景]，[角色]对[角色][做了什么]，[情绪类型]，第1集，第001章
【剧情3】[场景]，[角色]对[角色][做了什么]，[情绪类型]，第2集，第001章
...
\`\`\`

---

### 分集判断标准

**每集包含剧情点数量**：

| 剧情点特征 | 每集数量 | 总字数估算 |
|-----------|---------|-----------|
| **高强度钩子**（10-9分） | 1个 | 600-800字 |
| **中强度钩子**（8-7分） | 1-2个 | 500-700字 |
| **低强度钩子**（6分） | 2-3个 | 500-600字 |

**分集原则**：
- 高潮时刻单独成集（如打脸、碾压、身份曝光）
- 过渡剧情合并成集（如修炼过程、赶路）
- 确保每集有明确的起承转钩结构

**分集示例**：
\`\`\`
第1集（2个剧情点）：
【剧情1】被退婚羞辱，打脸蓄力
【剧情2】觉醒签到系统，金手指觉醒

第2集（1个剧情点）：
【剧情3】神文课堂大放异彩，初露锋芒

第3集（2个剧情点）：
【剧情4】月度考核越级秒杀，碾压爽点
【剧情5】被破格提拔核心弟子，身份提升
\`\`\`

---

### 压缩策略（通用）

**策略1：冲突合并法**
\`\`\`
小说：章1冲突A + 章2过渡 + 章3冲突B + 章4过渡 + 章5冲突C
                    ↓
漫剧：第N集（冲突A+B+C合并，删除过渡）

原则：
- 删除所有过渡章节
- 保留冲突和爽点
- 合并同类型冲突
\`\`\`

**策略2：时间跳跃法**
\`\`\`
小说：5章修炼过程详细描写
                    ↓
漫剧：【蒙太奇】10秒展示 + 【文字】"三天后"

原则：
- 删除过程描写
- 只保留结果展示
- 用特效和文字说明时间跨度
\`\`\`

**策略3：信息前置法**
\`\`\`
小说：章1-5铺垫 → 章6爆发
                    ↓
漫剧：第N集直接爆发 → 用【闪回】补充背景

原则：
- 爽点前置，先爽再解释
- 用闪回/对话补充信息
- 不要慢节奏铺垫
\`\`\`

**策略4：删繁就简法**
\`\`\`
必删内容：
❌ 环境描写（山川风景、房间布置）
❌ 心理独白（长篇内心戏）
❌ 过渡情节（赶路、日常、闲聊）
❌ 支线剧情（与主线无关）
❌ 重复内容（相似情节只保留最精彩的）

必留内容：
✅ 冲突对话
✅ 动作场景
✅ 情绪爆点
✅ 悬念设置
✅ 关系展示
\`\`\`

**策略5：支线取舍法**
\`\`\`
原则：
- 主线：完整保留（80%篇幅）
- 重要支线：精简保留（15%篇幅）
- 次要支线：极度压缩（5%篇幅）
- 无关支线：完全删除

判断标准：
- 主线：直接关系主角成长和终极目标
- 重要支线：影响主线发展的关键人物线
- 次要支线：丰富世界观但可有可无
- 无关支线：删除不影响理解
\`\`\`

---

## 四、人物体系整理

### 从小说提取人物

**任务**：从小说中提取所有角色，分类整理

**人物分类**：

| 类别 | 定义 | 改编策略 |
|------|------|---------|
| **主角** | 第一主角 | 完整保留 |
| **主要配角** | 对主线有重要影响的角色（3-5人） | 保留，适度简化 |
| **次要配角** | 有一定戏份但非核心的角色（5-10人） | 精简保留或合并 |
| **炮灰工具人** | 推动情节的龙套（无数） | 极度简化，同类型合并 |
| **最终对手** | 终极boss | 完整保留 |

---

### 人物简化原则

**原则1：工具人化**
\`\`\`
小说：每个配角都有详细背景和性格
                    ↓
漫剧：配角只保留功能性，删除背景故事

示例：
小说中的"长老A"有完整人生经历
漫剧中只需要"见证主角强大的长老"
\`\`\`

**原则2：角色合并**
\`\`\`
小说：三个反派分别在不同章节出现
                    ↓
漫剧：合并为一个反派，或者分批次使用

合并条件：
- 功能相似
- 不影响理解
- 可以合并台词和冲突
\`\`\`

**原则3：关系简化**
\`\`\`
小说：复杂的人物关系网
                    ↓
漫剧：只保留核心关系

保留：
✓ 主角vs主要对手
✓ 主角与重要配角的关系
✓ 直接影响剧情的关系

删除：
❌ 次要人物之间的关系
❌ 复杂的家族关系网
❌ 不影响主线的人物线
\`\`\`

---

### 人物改编清单

**标准人物清单模板**：
\`\`\`markdown
## 人物清单（改编版）

### 主角
**姓名**：[...]
- 小说中的身份：[...]
- 改编后的身份：[...]（简化版）
- 核心特征：[2-3个标签]
- 金手指/能力：[...]
- 主要关系：[vs谁]

### 主要配角（3-5人）
**姓名**：[...]
- 功能定位：[打脸对象/权威见证/成长助力/最终对手]
- 核心特征：[1-2个标签]
- 与主角关系：[...]
- 保留原因：[...]

### 炮灰工具人（分批）
**类型**：[第X-X集反派/长老/围观者]
- 功能：[被打脸/见证/推动剧情]
- 简化策略：[合并同类型/极简描述]

### 删除角色清单
- [角色名]：删除原因 - [与主线无关/戏份太少/可合并]
\`\`\`

---


## 五、付费转化设计

### 付费节点布局

**核心理念**：
- 付费点 = 第20集结尾 = 情绪最高潮 + 悬念最顶点
- 必须让观众"不看下集会死"
- 绝不是故事自然结束

**标准付费节点**：
\`\`\`
免费段：第1-20集
第20集结尾：卡最强悬念（免费段的最后一集）

付费后：全部解锁
\`\`\`

---

### 第20集大爆点设计

**要求**：免费段的最后一集，必须让观众欲罢不能

**设计方法**：
1. 从小说中找到前期最强的冲突高潮
2. 卡在即将爆发的时刻
3. 可以是：即将战斗/即将身份曝光/即将真相揭露

**示例**：
\`\`\`
【画面】主角vs强敌，激战正酣
【对白】"就让你见识一下，我真正的实力！"
【特写】主角眼神一变，气势爆发
【卡黑】
\`\`\`

**关键**：
- 第20集前的剧情要为此蓄力
- 爆点要足够震撼
- 悬念要吊足胃口

---

## 六、类型特殊要点

${getGenreStrategy(genre)}

---

## 七、改编禁忌与原则

### 致命错误（导致失败）

**❌ 错误1：过度忠于原著**
\`\`\`
问题：试图保留小说所有内容，导致节奏拖沓
结果：观众流失，付费率低

正确做法：
✓ 大胆删减，只保留核心冲突和爽点
✓ 不要有"舍不得删"的心态
\`\`\`

**❌ 错误2：节奏过慢**
\`\`\`
问题：保留了小说的铺垫和过渡
结果：观众3秒就滑走了

正确做法：
✓ 3秒进冲突，瞬间抓眼球
✓ 删除所有铺垫和过渡
✓ 爽点前置，先爽再解释
\`\`\`

**❌ 错误3：心理描写过多**
\`\`\`
问题：保留了小说的心理独白和内心戏
结果：画面无法展现，观众看不懂

正确做法：
✓ 心理→动作（用动作展现情绪）
✓ 心理→对话（用对话说出心声）
✓ 心理→删除（不重要的直接删）
\`\`\`

**❌ 错误4：支线过多**
\`\`\`
问题：试图保留所有支线剧情
结果：主线模糊，观众不知道在看什么

正确做法：
✓ 只保留主线（80%）
✓ 重要支线精简保留（15%）
✓ 其他支线全部删除（5%）
\`\`\`

**❌ 错误5：人物过多**
\`\`\`
问题：保留了小说中的所有角色
结果：观众记不住，人物混乱

正确做法：
✓ 主角+主要配角（5-8人）
✓ 炮灰工具人合并同类型
✓ 无关角色完全删除
\`\`\`

---

### 改编核心原则（必须遵守）

**✅ 原则1：情绪钩子优先**
\`\`\`
选择标准：
- 有爽点的内容 > 完整的故事
- 能让观众"卧槽"的情节 > 逻辑严密的情节
- 情绪刺激强度 > 文学性

实施方法：
- 从小说中识别所有高强度情绪钩子
- 优先保留10-8分的钩子
- 围绕钩子重构故事
\`\`\`

**✅ 原则2：视觉化优先**
\`\`\`
转换标准：
- 能拍成画面的 > 抽象的描写
- 动作场景 > 心理描写
- 对话冲突 > 内心独白

实施方法：
- 所有内容必须可视化
- 用※△【】标注场景/动作/特效
- 删除无法转化为画面的内容
\`\`\`

**✅ 原则3：快节奏强制**
\`\`\`
节奏要求：
- 3秒进冲突
- 每30秒必有推进
- 每集必有悬念【卡黑】
- 全程无尿点

实施方法：
- 删除所有铺垫和过渡
- 场景快速切换
- 用蒙太奇压缩时间
\`\`\`

**✅ 原则4：尊重原作结构**
\`\`\`
设计逻辑：
- 保持小说原有故事结构
- 不强行重构三幕式
- 集数根据内容自然生成
- 单集确保起承转钩结构

实施方法：
- 按小说顺序拆解剧情
- 拆解时直接标注分集
- 不提前设定目标集数
\`\`\`

**✅ 原则5：算法友好**
\`\`\`
优化目标：
- 完播率：每集结尾强悬念
- 互动率：设置争议点/吐槽点
- 传播率：金句台词可截图

实施方法：
- 每集必须【卡黑】
- 人物性格/台词要有争议性
- 台词简短、霸气、可传播
\`\`\`

---

## 总结：改编成功的关键

**改编 ≠ 翻译**：
- 不是把小说文字转成剧本文字
- 而是提取情绪钩子，重构叙事节奏

**核心公式**：
\`\`\`
成功改编 = 情绪钩子提取 × 冲突密度压缩 × 视觉语言转化 × 节奏强制重构
\`\`\`

**三大法则**：
1. 情绪钩子密度 > 故事完整性
2. 尊重原作结构 > 强行重构三幕
3. 算法友好性 > 戏剧逻辑性

`


export const getAdaptMethod = (batchSize: number, genre: NovelType) => `
---
name: adapt-method
description: 网文改编漫剧创作方法论（通用版），适用于60万-300万字长篇小说改编为动态漫剧，包含小说解析、冲突提取、情绪钩子识别、剧情拆解、分集标注、节奏控制等全流程指导
---


# 网文改编漫剧创作方法论（通用版）

## 总体取向

**改编的本质**：不是"翻译"，而是"重构"

网文改编漫剧的核心是**提取情绪钩子、压缩冲突密度、转化视觉语言、重构叙事节奏**。

**核心原则**：
- 情绪钩子密度 > 故事完整性
- 视觉冲击力 > 文学性描写
- 快节奏刺激 > 慢节奏沉浸
- 算法友好性 > 戏剧逻辑性

**改编对象**：
- **小说类型**：玄幻、武侠、都市、言情、古言、悬疑、推理、科幻、末世、重生等所有类型
- **小说长度**：60万-300万字长篇网文
- **目标产品**：动态集数漫剧（每集1-2分钟，集数根据内容自然生成）

**漫剧基本规格**：
- **每集时长**：1-2分钟
- **每集字数**：500-800字
- **集数**：根据小说内容自然生成（不提前设定）

---

## 整体改编公式
\`\`\`
网文改编漫剧 = 情绪钩子提取 + 冲突密度压缩 + 视觉语言转化 + 节奏强制重构
\`\`\`

**叙事结构**：
- **季弧（整体）**：保持小说原有故事结构，不强行重构
- **集内（单集）**：采用起承转钩四段式（起-开场冲突、承-推进发展、转-反转高潮、钩-悬念结尾）

**改编思维转换**：

| 维度 | 原创思维 | 改编思维 |
|------|---------|---------|
| **起点** | 从零构思故事 | 从已有小说提取精华 |
| **目标** | 讲好一个故事 | 提取最爽的情绪钩子 |
| **结构** | 自由设计 | 尊重小说原有结构，不强行重构 |
| **人物** | 自由创造 | 从小说提取，需简化 |
| **节奏** | 自由把控 | 需大幅压缩，删繁就简 |
| **集数** | 自由确定 | 根据内容密度自然生成 |

---


## 一、冲突点识别与提取

### 冲突点定义

**什么是冲突点**：
- 推动情节发展的关键事件
- 让观众产生情绪波动的时刻
- 角色之间的对立和碰撞
- 主角面临的挑战和危机

**冲突点 ≠ 情节点**：
- 情节点：所有发生的事件（包括过渡、铺垫、日常）
- 冲突点：有张力、有对立、有情绪的事件

---

### 冲突点识别方法

**识别标准**：

**A. 强度分级**

| 等级 | 定义 | 特征 | 改编策略 |
|------|------|------|---------|
| **⭐⭐⭐ 核心冲突** | 推动主线的关键事件 | 改变主角命运、大幅改变格局 | 必须保留，独立成集 |
| **⭐⭐ 次级冲突** | 推动支线或铺垫的事件 | 推进剧情但非关键转折 | 选择性保留，可合并 |
| **⭐ 过渡冲突** | 日常、铺垫、环境描写 | 无明显对立和张力 | 删除或极度压缩 |

**B. 类型识别**（跨类型通用）

| 冲突类型 | 定义 | 示例 |
|---------|------|------|
| **人物对立** | 角色之间的直接冲突 | 主角vs反派、误会、背叛 |
| **力量对比** | 实力差距引发的冲突 | 越级挑战、碾压、觉醒 |
| **身份矛盾** | 身份差异引发的冲突 | 贵贱对立、隐藏身份、真相揭露 |
| **情感纠葛** | 情感关系引发的冲突 | 误会、背叛、虐恋、三角恋 |
| **生存危机** | 生死存亡的冲突 | 追杀、危机、末世、绝境 |
| **真相悬念** | 谜团引发的冲突 | 凶手是谁、幕后黑手、身世之谜 |

---

### 冲突点提取策略

**提取步骤**：

**第一步：批量阅读**
- 每次阅读${batchSize}章
- 快速识别所有冲突点
- 标注冲突类型和强度

**第二步：筛选分级**
- ⭐⭐⭐ 核心冲突：标记为"必保留"
- ⭐⭐ 次级冲突：标记为"可保留"
- ⭐ 过渡冲突：标记为"删除"

**第三步：密度统计**
\`\`\`
冲突密度 = ${batchSize}章内的核心冲突数量

高密度：${batchSize}章内有 5个以上核心冲突
中密度：${batchSize}章内有 2-4个核心冲突  
低密度：${batchSize}章内有 0-1个核心冲突
\`\`\`

**第四步：改编策略**
- 高密度：保留大部分冲突，适度合并
- 中密度：保留核心冲突，删除次级冲突
- 低密度：只保留核心冲突，大量压缩

---

### 冲突点识别模板

**标准识别清单**（每${batchSize}章填写）：
\`\`\`markdown
## 第[X-X]章 冲突点识别清单

### 核心冲突（⭐⭐⭐）
1. **冲突描述**：[...]
   - 位置：第X章
   - 类型：[人物对立/力量对比/身份矛盾/情感纠葛/生存危机/真相悬念]
   - 涉及角色：[主角vs谁]
   - 情绪强度：[1-10分]
   - 改编价值：[高/中/低]

2. **冲突描述**：[...]
   - ...

### 次级冲突（⭐⭐）
1. **冲突描述**：[...]
   - ...

### 冲突密度评估
- 核心冲突数量：[X个]
- 密度评级：[高/中/低]
- 压缩策略：[...]
\`\`\`

---

## 二、情绪钩子提取与标注

### 情绪钩子定义

**什么是情绪钩子**：
- 能让观众产生强烈情绪反应的情节点
- 让观众"卧槽/爽/哭/笑/急"的时刻
- 短视频中让观众停留的"钩子"

**情绪钩子 vs 冲突点**：
- 冲突点：所有有对立的事件
- 情绪钩子：冲突点中最能引发情绪的高潮时刻

---

### 情绪钩子类型（跨类型通用）

**通用情绪钩子清单**：

| 情绪类型 | 钩子示例 | 适用类型 |
|---------|---------|---------|
| **爽感钩子** | 打脸、碾压、装X、反杀、复仇成功 | 玄幻、都市、武侠、重生 |
| **虐心钩子** | 误会、背叛、生离死别、痛苦抉择 | 言情、古言 |
| **悬疑钩子** | 真相揭露、身份曝光、反转、揭秘 | 悬疑、推理 |
| **紧张钩子** | 危机、追杀、死亡威胁、倒计时 | 科幻、末世、动作 |
| **温情钩子** | 守护、牺牲、感动、团圆 | 所有类型 |
| **反差钩子** | 身份反转、实力曝光、扮猪吃虎 | 所有类型 |

**不同类型的专属钩子**：

**玄幻/武侠**：
- 境界突破、越级碾压、身份曝光、血脉觉醒
- 打脸羞辱、宗门大比、秘境奇遇、宝物争夺

**都市/现代**：
- 身份揭露、财富对比、地位碾压、真相大白
- 前妻后悔、商战对决、阴谋揭穿、豪门恩怨

**言情/古言**：
- 误会解除、虐恋虐心、真心表白、强制爱
- 破镜重圆、宠溺反差、吃醋争风、生离死别

**悬疑/推理**：
- 凶手曝光、真相反转、证据发现、关键线索
- 危机时刻、死亡威胁、时间倒计时、最后一搏

**科幻/末世**：
- 异能觉醒、丧尸危机、基地争夺、黑科技展示
- 人性考验、背叛求生、团队对抗、终极一战

**重生复仇**：
- 先知剧情、改变命运、打脸前世仇敌、提前布局
- 夺取机缘、避开危险、身份反转、复仇成功

---

### 情绪钩子提取方法

**提取标准**：

**A. 情绪强度评分**（1-10分）
\`\`\`
10分：让观众"卧槽！"的时刻（必须单独成集）
8-9分：让观众爽/虐/急的高潮（核心爽点）
6-7分：让观众有感觉的时刻（可保留）
4-5分：情绪平淡（可删除）
1-3分：无情绪波动（必须删除）
\`\`\`

**B. 提取公式**
\`\`\`
每${batchSize}章小说 → 识别3-8个情绪钩子（10-6分）

高密度：${batchSize}章有 6-8个高强度钩子
中密度：${batchSize}章有 3-5个高强度钩子
低密度：${batchSize}章有 1-2个高强度钩子
\`\`\`

**C. 钩子识别清单**
\`\`\`markdown
## 情绪钩子提取清单（第X-X章）

### 高强度钩子（10-8分）
1. **钩子描述**：[...]
   - 位置：第X章
   - 情绪类型：[爽感/虐心/悬疑/紧张/温情/反差]
   - 强度评分：[X/10]
   - 涉及角色：[...]
   - 改编策略：[单独成集/核心爽点]

2. **钩子描述**：[...]
   - ...

### 中强度钩子（7-6分）
1. **钩子描述**：[...]
   - 改编策略：[可保留/可合并]

### 钩子密度
- 高强度钩子：[X个]
- 中强度钩子：[X个]
- 平均密度：[每X章一个高强度钩子]
\`\`\`

---


## 三、人物体系整理

### 从小说提取人物

**任务**：从小说中提取所有角色，分类整理

**人物分类**：

| 类别 | 定义 | 改编策略 |
|------|------|---------|
| **主角** | 第一主角 | 完整保留 |
| **主要配角** | 对主线有重要影响的角色（3-5人） | 保留，适度简化 |
| **次要配角** | 有一定戏份但非核心的角色（5-10人） | 精简保留或合并 |
| **炮灰工具人** | 推动情节的龙套（无数） | 极度简化，同类型合并 |
| **最终对手** | 终极boss | 完整保留 |

---

### 人物简化原则

**原则1：工具人化**
\`\`\`
小说：每个配角都有详细背景和性格
                    ↓
漫剧：配角只保留功能性，删除背景故事

示例：
小说中的"长老A"有完整人生经历
漫剧中只需要"见证主角强大的长老"
\`\`\`

**原则2：角色合并**
\`\`\`
小说：三个反派分别在不同章节出现
                    ↓
漫剧：合并为一个反派，或者分批次使用

合并条件：
- 功能相似
- 不影响理解
- 可以合并台词和冲突
\`\`\`

**原则3：关系简化**
\`\`\`
小说：复杂的人物关系网
                    ↓
漫剧：只保留核心关系

保留：
✓ 主角vs主要对手
✓ 主角与重要配角的关系
✓ 直接影响剧情的关系

删除：
❌ 次要人物之间的关系
❌ 复杂的家族关系网
❌ 不影响主线的人物线
\`\`\`

---

### 人物改编清单

**标准人物清单模板**：
\`\`\`markdown
## 人物清单（改编版）

### 主角
**姓名**：[...]
- 小说中的身份：[...]
- 改编后的身份：[...]（简化版）
- 核心特征：[2-3个标签]
- 金手指/能力：[...]
- 主要关系：[vs谁]

### 主要配角（3-5人）
**姓名**：[...]
- 功能定位：[打脸对象/权威见证/成长助力/最终对手]
- 核心特征：[1-2个标签]
- 与主角关系：[...]
- 保留原因：[...]

### 炮灰工具人（分批）
**类型**：[第X-X集反派/长老/围观者]
- 功能：[被打脸/见证/推动剧情]
- 简化策略：[合并同类型/极简描述]

### 删除角色清单
- [角色名]：删除原因 - [与主线无关/戏份太少/可合并]
\`\`\`

---

## 四、节奏控制（漫剧生命线）

### 单集节奏公式（1-2分钟）- 起承转钩四段式

漫剧单集采用**起承转钩**四段式叙事结构，每个阶段职责明确：

**【起】开场冲突（0-15秒，约100-150字）**
- **作用**：3秒抓眼球，瞬间进入冲突
- **内容**：羞辱/战斗/危机/反转，立即呈现
- **禁忌**：不要环境描写、不要铺垫、不要慢节奏
- **改编要点**：从小说中提取最冲突的开场时刻

**【承】推进发展（15-30秒，约150-200字）**
- **作用**：展示过程，为爽点铺垫
- **内容**：对话推进/力量展示/策略布局
- **要点**：保持节奏，不拖沓，爽点初现
- **改编要点**：从小说中提取关键对话和动作，删除心理描写

**【转】反转高潮（30-50秒，约200-250字）**
- **作用**：核心爽点爆发，情绪达到峰值
- **内容**：打脸/升级/碾压/身份曝光/真相揭露
- **重点**：这一集最爽的部分，必须震撼
- **改编要点**：从小说中提取最高潮的爽点时刻，强化视觉冲击

**【钩】悬念钩子（50-60秒，约100-150字）**
- **作用**：强制卡黑，吸引观众看下一集
- **内容**：新危机/新悬念/更强敌人出现
- **必须**：【卡黑】不可省略
- **改编要点**：可能需要从小说下一章节借素材制造悬念

---

### 节奏控制原则

**原则1：3秒进冲突**
\`\`\`
❌ 小说开场：环境描写、人物介绍、背景铺垫
✅ 漫剧开场：立即进入冲突现场

改编方法：
- 删除小说前3章的铺垫
- 直接从冲突爆发开始
- 用对话/闪回补充必要信息
\`\`\`

**原则2：每30秒必有推进**
\`\`\`
要求：
- 每30秒必有新信息
- 每30秒情节必有进展
- 不能停滞，不能重复

改编方法：
- 删除小说中的重复内容
- 压缩对话，删除废话
- 快速切换场景
\`\`\`

**原则3：禁止过长单一画面**
\`\`\`
❌ 小说：一章都在一个场景
✅ 漫剧：每集1-3个场景，快速切换

改编方法：
- 将小说的长场景切分
- 增加场景变化
- 用蒙太奇快速过渡
\`\`\`

---

### 每集结尾悬念设置（必须）

**悬念类型**（跨类型通用）：

| 类型 | 适用情况 | 示例 |
|------|---------|------|
| **战斗悬念** | 战斗/对决即将爆发 | "能赢吗？"【卡黑】 |
| **身份悬念** | 身份即将曝光 | "他到底是谁？"【卡黑】 |
| **危机悬念** | 更强敌人/危机出现 | "更强的来了！"【卡黑】 |
| **真相悬念** | 真相即将揭露 | "原来是他！"【卡黑】 |
| **情感悬念** | 误会即将解除/恶化 | "她知道了吗？"【卡黑】 |

**设置方法**：
\`\`\`
从小说下一章开头借素材：
- 下章开头的冲突 → 提前在本集结尾预告
- 下章出现的新角色 → 本集结尾让他露面
- 下章的反转 → 本集结尾埋伏笔

禁止平淡收尾：
❌ "然后主角回去睡觉了"
❌ "这一天就这样过去了"
❌ 任何解决问题的收尾
\`\`\`

---

## 五、付费转化设计

### 付费节点布局

**核心理念**：
- 付费点 = 第20集结尾 = 情绪最高潮 + 悬念最顶点
- 必须让观众"不看下集会死"
- 绝不是故事自然结束

**标准付费节点**：
\`\`\`
免费段：第1-20集
第20集结尾：卡最强悬念（免费段的最后一集）

付费后：全部解锁
\`\`\`

---

### 第20集大爆点设计

**要求**：免费段的最后一集，必须让观众欲罢不能

**设计方法**：
1. 从小说中找到前期最强的冲突高潮
2. 卡在即将爆发的时刻
3. 可以是：即将战斗/即将身份曝光/即将真相揭露

**示例**：
\`\`\`
【画面】主角vs强敌，激战正酣
【对白】"就让你见识一下，我真正的实力！"
【特写】主角眼神一变，气势爆发
【卡黑】
\`\`\`

**关键**：
- 第20集前的剧情要为此蓄力
- 爆点要足够震撼
- 悬念要吊足胃口

---

# 六、、类型特殊要点

${getGenreStrategy(genre)}
---

## 七、改编禁忌与原则

### 致命错误（导致失败）

**❌ 错误1：过度忠于原著**
\`\`\`
问题：试图保留小说所有内容，导致节奏拖沓
结果：观众流失，付费率低

正确做法：
✓ 大胆删减，只保留核心冲突和爽点
✓ 不要有"舍不得删"的心态
\`\`\`

**❌ 错误2：节奏过慢**
\`\`\`
问题：保留了小说的铺垫和过渡
结果：观众3秒就滑走了

正确做法：
✓ 3秒进冲突，瞬间抓眼球
✓ 删除所有铺垫和过渡
✓ 爽点前置，先爽再解释
\`\`\`

**❌ 错误3：心理描写过多**
\`\`\`
问题：保留了小说的心理独白和内心戏
结果：画面无法展现，观众看不懂

正确做法：
✓ 心理→动作（用动作展现情绪）
✓ 心理→对话（用对话说出心声）
✓ 心理→删除（不重要的直接删）
\`\`\`

**❌ 错误4：支线过多**
\`\`\`
问题：试图保留所有支线剧情
结果：主线模糊，观众不知道在看什么

正确做法：
✓ 只保留主线（80%）
✓ 重要支线精简保留（15%）
✓ 其他支线全部删除（5%）
\`\`\`

**❌ 错误5：人物过多**
\`\`\`
问题：保留了小说中的所有角色
结果：观众记不住，人物混乱

正确做法：
✓ 主角+主要配角（5-8人）
✓ 炮灰工具人合并同类型
✓ 无关角色完全删除
\`\`\`

---

### 改编核心原则（必须遵守）

**✅ 原则1：情绪钩子优先**
\`\`\`
选择标准：
- 有爽点的内容 > 完整的故事
- 能让观众"卧槽"的情节 > 逻辑严密的情节
- 情绪刺激强度 > 文学性

实施方法：
- 从小说中识别所有高强度情绪钩子
- 优先保留10-8分的钩子
- 围绕钩子重构故事
\`\`\`

**✅ 原则2：视觉化优先**
\`\`\`
转换标准：
- 能拍成画面的 > 抽象的描写
- 动作场景 > 心理描写
- 对话冲突 > 内心独白

实施方法：
- 所有内容必须可视化
- 用※△【】标注场景/动作/特效
- 删除无法转化为画面的内容
\`\`\`

**✅ 原则3：快节奏强制**
\`\`\`
节奏要求：
- 3秒进冲突
- 每30秒必有推进
- 每集必有悬念【卡黑】
- 全程无尿点

实施方法：
- 删除所有铺垫和过渡
- 场景快速切换
- 用蒙太奇压缩时间
\`\`\`

**✅ 原则4：尊重原作结构**
\`\`\`
设计逻辑：
- 保持小说原有故事结构
- 不强行重构三幕式
- 集数根据内容自然生成
- 单集确保起承转钩结构

实施方法：
- 按小说顺序拆解剧情
- 拆解时直接标注分集
- 不提前设定目标集数
\`\`\`

**✅ 原则5：算法友好**
\`\`\`
优化目标：
- 完播率：每集结尾强悬念
- 互动率：设置争议点/吐槽点
- 传播率：金句台词可截图

实施方法：
- 每集必须【卡黑】
- 人物性格/台词要有争议性
- 台词简短、霸气、可传播
\`\`\`

---

## 总结：改编成功的关键

**改编 ≠ 翻译**：
- 不是把小说文字转成剧本文字
- 而是提取情绪钩子，重构叙事节奏

**核心公式**：
\`\`\`
成功改编 = 情绪钩子提取 × 冲突密度压缩 × 视觉语言转化 × 节奏强制重构
\`\`\`

**三大法则**：
1. 情绪钩子密度 > 故事完整性
2. 尊重原作结构 > 强行重构三幕
3. 算法友好性 > 戏剧逻辑性

**标准流程**：
\`\`\`
确定小说类型
    ↓
每6章拆解剧情（提取+删除+分集）
    ↓
生成单集剧本（500-800字，起承转钩）
    ↓
确保第20集大爆点（付费转化）
\`\`\`

**质量标准**：
- 3秒进冲突 ✓
- 视觉化描述 ✓
- 快节奏推进 ✓
- 强制悬念【卡黑】 ✓
- 每集1-3个剧情点 ✓

---

**【改编心法】**
\`\`\`
抓住情绪，删除废话
视觉优先，节奏为王
尊重原作，不强行重构
逐章拆解，自然生成集数
\`\`\`

**记住**：观众不是来"看故事"的，而是来"获得情绪刺激"的。你的任务不是"忠于原著"，而是"提取最爽的部分"。
`;

export const OUTPUT_STYLE = `
---
name: output-style
description: 网文改编漫剧的输出风格，语言简洁有力、视觉冲击强烈、节奏极快无尿点、情绪钩子密集爆发。适用于所有类型网文改编（玄幻、都市、言情、悬疑、科幻、重生等）
---

# 写作风格总则
- 视觉化优先：一切为画面服务，描述观众能看到的具体画面，每句话都能转化为视觉内容
- 节奏极快：快速推进，瞬间进冲突，无废话无铺垫，直奔情绪钩子
- 情绪钩子密集：每集必有打脸/反转/碾压/真相揭露，观众爽了就是王道
- 冲突可视化：力量对比、身份反差、情感张力用画面展示，观众秒懂
- 对话简短有力：冲突对话用3句话，反击用1句话，台词要霸气可传播
- 悬念强制：每集结尾必须卡悬念，让观众欲罢不能点下一集
- 改编重构原则：心理→动作，叙述→画面，铺垫→删除，过程→结果
- 信息前置：爽点前置先爽再解释，用闪回/对话补充背景，不要慢节奏铺垫

## 漫剧特殊规格
- **每集时长**：1-2分钟（60-120秒）
- **每集字数**：500-800字
- **场景数量**：每集1-3个场景
- **对话密度**：对话占30-40%，动作描写占40-50%，心理/旁白占10-20%
- **节奏公式**：起承转钩（起-冲突 → 承-推进 → 转-高潮 → 钩-悬念）

---

## 具体行为

### 改编开场冲突时（起）
- **瞬间进入画面**：不要铺垫，开场就是冲突现场
  - ✅ ※ 豪华宴会厅<br>△ 妻子当众撕毁结婚证："你这废物，连房租都交不起！"<br>△ 全场名流冷笑
  - ❌ 这是一个风和日丽的下午，某市最豪华的酒店里正在举办一场盛大的宴会……（太慢，观众已滑走）
- **用视觉冲击抓眼**：羞辱场面、冲突现场、危机时刻、反转画面
  - ✅ △ 主角被一巴掌扇飞，鲜血飙出，砸碎餐桌<br>△ 众宾客指点嘲笑
  - ❌ 主角被打了一下，大家都觉得他很惨。（无画面感）
- **对话要狠要短**：冲突台词要扎心，3句话说完
  - ✅ "三年了，你一事无成！""今天，我要离婚！""保安，把他赶出去！"
  - ❌ "我觉得我们之间的感情已经没有了，我想了很久，还是决定……"（太啰嗦）

### 改编转折/契机时（金手指/觉醒/回归）
- **快速给予**：从小说中提取转折点，快速完成
  - ✅ △ 一道神秘电话打来："少爷，是时候回归了"<br>【特效】手机屏幕显示惊人数字<br>△ 主角眼神骤变
  - ❌ 主角感觉到一些变化，他开始思考这意味着什么，慢慢地他明白了……（太慢）
- **信息要清晰**：用画面/对话/文字说明转折
  - ✅ 【文字】三年前的那个夜晚<br>【闪回】主角真实身份一闪而过<br>△ 主角："今天，游戏结束了"
  - ❌ 主角想起了一些事情。（观众不知道想起了什么）
- **主角反应要爽**：震惊→冷笑→决心，情绪递进
  - ✅ △ 主角愣住，随即嘴角勾起冷笑<br>△ "等着吧，今天就让你们知道什么叫后悔"
  - ❌ 主角很高兴。（太平淡）

### 改编升级/成长时
- **蒙太奇快速展示**：从小说删除过程描写，只保留结果
  - ✅ 【蒙太奇】<br>△ 训练场景快速闪过<br>【特效】能力提升画面<br>【文字】三个月后<br>【画面】主角脱胎换骨
  - ❌ 接下来的日子里，主角开始刻苦训练。第一天他练习基础动作，第二天……（太拖沓）
- **数值/对比要可视化**：用画面展示前后差距（适用玄幻/科幻/游戏等类型）
  - ✅ 【对比画面】<br>【前】瘦弱、眼神躲闪<br>【后】精壮、眼神凌厉<br>【文字】战力值：500→50000
  - ❌ 他变强了很多。（观众不知道强了多少）
- **展示力量感**：用视觉特效展现成长（根据类型调整）
  - ✅ △ 主角随手一挥，巨石粉碎<br>△ 众人震惊失声
  - ❌ 主角变得很厉害了。（无视觉冲击）

### 改编打脸场景时（核心情绪钩子）
- **对比要强烈**：从小说提取前后对比，形成强烈反差
  - ✅ △ "你这穷鬼也配来这里？"富二代冷笑<br>【转折】<br>△ 主角掏出黑金卡："经理，把他轰出去"<br>△ 富二代脸色惨白
  - ❌ 富二代嘲笑主角，但主角其实很有钱，大家都很惊讶。（无冲击力）
- **一招制敌最爽**：不要拖沓过程，碾压要干脆
  - ✅ △ 主角眼神一冷，一个电话<br>△ 对方公司股价暴跌，破产<br>△ 对方跪地求饶
  - ❌ 主角和对方斗智斗勇了很久，最后主角赢了。（不够爽）
- **围观者反应必须有**：震惊、跪拜、惊呼，烘托主角强大
  - ✅ △ 全场震惊失声<br>△ "他...他竟然是...""天哪！""我们惹了不该惹的人！"<br>△ 众人瞬间改变态度
  - ❌ 大家都很惊讶。（太平淡）

### 改编越级挑战/反杀时（适用玄幻/武侠/科幻等）
- **实力差距要明示**：用文字/对话点明差距
  - ✅ 【文字】LV10 VS LV50！<br>△ 对手冷笑："找死！区区十级也敢挑战我？"
  - ❌ 主角挑战了一个比他强的人。（观众不知道差多少）
- **战斗要有来回**：不能一招秒，要展示主角底牌
  - ✅ 【前半段】<br>△ 主角被压制，险象环生<br>【转折】<br>△ 主角："该认真了"<br>【特效】隐藏能力爆发<br>【后半段】<br>△ 局势逆转，对手被碾压
  - ❌ 主角虽然等级低，但还是赢了。（过程太简略）
- **底牌释放要震撼**：特效、慢动作、音效，视听冲击拉满
  - ✅ △ 主角眼神骤变<br>【慢动作】隐藏技能发动，能量狂涌<br>△ 一击轰出，震撼全场<br>【音效】爆裂音效
  - ❌ 主角使用了隐藏能力，很强。（无震撼感）

### 改编身份揭露时（高潮点）
- **铺垫要隐蔽**：从小说中提取线索，不要太明显
  - ✅ 【第5集闪回】神秘电话一闪而过<br>【第15集】管家恭敬出现，被主角制止<br>【第40集】真相大白："他竟是XX集团继承人！"
  - ❌ 第1集就暗示：主角其实身份不简单……（太明显）
- **揭露要震撼**：用视觉特效+所有人震惊反应
  - ✅ 【特效】豪车车队、保镖列队<br>△ 管家单膝下跪："少爷，该回家了"<br>△ 所有人震撼失声<br>△ "那是...百亿集团的管家！""他竟是...！"
  - ❌ 大家发现主角身份不简单。（无震撼感）
- **身份反转要有料**：不是小身份，要是惊天大背景
  - ✅ "他是隐退十年的商业帝王！""他是失踪的豪门继承人！"
  - ❌ "原来他是某个小公司的人。"（格局太小）

### 改编前任/仇敌后悔时（打脸爽点）
- **对比要惨烈**：从小说提取前后对比，当初多嚣张，现在多凄惨
  - ✅ 【闪回】第1集妻子："你这废物配不上我！"<br>【现在】<br>△ 妻子跪在主角面前，泪流满面："我错了...求你原谅..."
  - ❌ 妻子后悔了，想求主角原谅。（对比不够强）
- **主角要够狠**：冷漠无视，不给任何机会
  - ✅ △ 主角眼神冰冷，看都没看她一眼，转身离去<br>△ "当初，是你看不起我。如今，你高攀不起"
  - ❌ "我已经不恨你了，你走吧。"（不够爽）
- **可选虐心选项**：前任下场（根据类型和小说原情节）
  - ✅ △ 前妻跪在雨中，绝望嘶吼<br>【文字】三日后，她跳楼自杀（适用虐文）
  - ❌ 前妻很后悔，但主角不理她。（不够惨，可根据需要调整）

### 改编装X台词时
- **要短要狠要霸气**：从小说提取或改写，不超过15字
  - ✅ "在我面前，你连说话的资格都没有。"
  - ✅ "跪下，我考虑饶你不死。"
  - ✅ "三招之内，必败你。"
  - ❌ "我觉得你的实力不是很强，可能打不过我，要不要考虑一下认输？"（太啰嗦）
- **配合动作/眼神**：装X不能只说，要有气场
  - ✅ △ 主角眼神冷漠，声音淡然："滚"<br>【特效】气势爆发<br>△ 对手直接跪地
  - ❌ 主角说："你滚吧。"（无气场）
- **禁止中二羞耻台词**：除非小说原有且适合
  - ✅ "不服？那就跪到服。"（简单霸气）
  - ❌ "吾乃天命之子，尔等蝼蚁竟敢在本座面前放肆？"（太中二，除非小说就是这个风格）

### 改编重生/先知场景时（重生题材专属）
- **前世记忆碎片化**：用【闪回】3-5秒快速展示
  - ✅ 【闪回灰色画面】前世被害场景<br>△ 主角眼神一凛："前世你害我，今生该还了"
  - ❌ 主角回忆起前世的事情，那时他被……（详细回忆，太慢）
- **先知优势要明确**：展示"我早知道"的爽感
  - ✅ △ 主角："三天后会有危机"<br>△ 配角："你怎么知道？"<br>△ 主角冷笑不语<br>【三天后】果然发生，众人震惊
  - ❌ 主角好像知道一些事情。（不够明确）
- **改变命运要对比**：前世vs今生，视觉对比强烈
  - ✅ 【闪回灰色】前世：主角错失机缘<br>【现在彩色】今生：主角提前夺取<br>△ 仇敌傻眼："怎么会...！"
  - ❌ 主角改变了一些事情。（无对比感）

### 改编真相揭露时（悬疑/推理题材专属）
- **线索要清晰**：从小说提取关键线索，逐步展示
  - ✅ 【线索1】第10集发现可疑照片<br>【线索2】第20集找到关键证据<br>【线索3】第30集真相大白
  - ❌ 主角慢慢调查，最后发现了真相。（过程模糊）
- **反转要震撼**：凶手/真相必须出人意料
  - ✅ △ 主角："凶手...竟然是你！"<br>△ 镜头转向最不可能的人<br>△ 全场震惊
  - ❌ 凶手被抓住了。（无震撼感）
- **揭露过程要快**：不要长篇解释，用画面+简短对话
  - ✅ 【闪回蒙太奇】各种证据快速闪过<br>△ 主角："所有线索指向你"<br>△ 凶手崩溃认罪
  - ❌ 主角详细解释了整个推理过程……（太长）

### 改编误会解除时（言情/虐恋题材专属）
- **误会要清晰**：从小说提取核心误会点
  - ✅ 【闪回】女主看到男主与他人暧昧（误会产生）<br>【现在】真相：那人是男主失散多年的妹妹
  - ❌ 他们之间有一些误会。（不清楚是什么）
- **解除要虐心**：真相揭开时的痛苦/后悔
  - ✅ △ 女主看到真相，泪流满面："原来...我误会了..."<br>△ 她跪在雨中，悔恨欲绝
  - ❌ 女主知道真相了，觉得很后悔。（情绪不够）
- **虐转甜要反差**：解除后的宠溺/弥补
  - ✅ △ 男主将她拥入怀中："傻瓜，我只爱你"<br>△ 温柔吻落，配乐转为温馨
  - ❌ 男主说他爱她。（太平淡）

### 改编对话时（漫剧特殊要求）
- **每句话不超过20字**：观众看字幕，太长看不完
  - ✅ "就凭你？"（3字，极简）
  - ✅ "三天后，我会让你们后悔。"（12字）
  - ❌ "三天后我会用我的实力证明给你们所有人看，让你们知道当初看不起我是多么错误的决定。"（太长）
- **一次只说一句话**：不要一个人连说三句
  - ✅ 主角冷笑："等着吧。"转身离去。
  - ❌ 主角说："等着吧。三天后我会让你们后悔。你们会跪在我面前求饶的。"（太多）
- **对话要推进剧情**：不要废话闲聊
  - ✅ "三天后，生死擂。敢来吗？"（挑衅+引出下一场戏）
  - ❌ "今天天气不错啊。""是啊。""你吃了吗？"（全是废话）

### 改编动作描写时（漫剧核心）
- **描述具体画面**：写观众能看到的动作和场景变化
  - ✅ △ 主角一拳轰出<br>△ 拳风破空而去<br>△ 对手被轰飞百米，砸穿墙壁
  - ❌ 主角打了对手一拳，对手飞出去了。（画面不具体）
- **用特效标注**：根据类型使用（能量、光效、爆炸、碎裂等）
  - ✅ 【特效】金色能量包裹拳头，轰出时空间震荡<br>【音效】音爆声
  - ❌ 他打出了很强的一拳。（无视觉效果）
- **用慢动作突出关键**：秒杀、反转、装X瞬间
  - ✅ 【慢动作】主角眼神一冷，随手一击<br>△ 对手被按进地面，地面龟裂
  - ❌ 主角轻松打败了对手。（无震撼感）

### 处理心理活动时（改编关键）
- **心理→动作**：用动作展现内心，不写心理独白
  - ✅ △ 主角拳头紧握，指甲刺破手心，鲜血滴落（用动作）
  - ❌ 主角心想：我一定要变强，我要报仇。（太多内心戏）
- **心理→对话**：必须表达时，转为对话或独白（极简）
  - ✅ 【独白】等着吧，很快了。（不超过10字）
  - ❌ 【独白】等着吧，我一定会变强的，到时候我要让你们所有人都后悔……（太长）
- **心理→删除**：小说中的大量心理描写，改编时直接删除
  - ✅ 从小说中删除无关紧要的内心戏
  - ❌ 保留小说中所有心理描写（漫剧无法表现）

### 处理节奏时（漫剧生命线）
- **开场瞬间进冲突**：删除小说的铺垫，开场就是冲突现场
  - ✅ ※ 豪华会议室<br>△ 董事长当众撕毁合同："你被开除了！"
  - ❌ 这是一个阳光明媚的早晨，主角来到公司……（观众已经滑走了）
- **快速推进不停歇**：删除小说的过渡，只保留冲突和爽点
  - ✅ 【起】羞辱场景 → 【承】身份曝光 → 【转】打脸高潮 → 【钩】新敌人出现
  - ❌ 用大量篇幅描写主角的日常生活。（太慢）
- **禁止过长单一画面**：要快速切换
  - ✅ 画面快速切换，保持节奏
  - ❌ 一个画面拍很长时间对话。（太闷）

### 每集结尾时（必须悬念）
- **战斗悬念**：卡在即将爆发的时刻
  - ✅ △ 主角："就让你见识一下，我真正的实力！"<br>△ 主角眼神骤变，气势爆发<br>【特效】能量冲天<br>【卡黑】
  - ❌ 主角打败了对手，然后回去了。（无悬念）
- **身份悬念**：留下谜团
  - ✅ △ 管家看到主角，脸色大变："少...少爷？！"<br>△ 主角特写<br>【卡黑】
  - ❌ 管家认出了主角的身份，觉得很惊讶。（说太明）
- **危机悬念**：更强敌人/危机出现
  - ✅ △ 一道强大气息降临<br>△ "有意思的小子"<br>△ 神秘人出现<br>【卡黑】
  - ❌ 后来又来了一个更强的敌人。（太平淡）
- **真相悬念**：真相即将揭露（悬疑类）
  - ✅ △ 主角翻开档案，瞳孔骤缩<br>△ "原来...是他！"<br>【卡黑】
  - ❌ 主角发现了一些线索。（无冲击）
- **禁止平淡收尾**：绝对不能"然后主角回去睡觉了"
  - ❌ 这一天就这样过去了。（必死）

---

## 语言禁忌

### 绝对不能出现
- ❌ 过度文言文："方才""尔等""吾乃""汝等"（除非原小说就是古言风格）
- ❌ 网文万能句："某某嘴角勾起一抹邪魅的笑""腹黑如他""霸气侧漏"
- ❌ 啰嗦描写："他感到一股前所未有的力量在体内涌动，这股力量让他感觉自己仿佛能够……"（太长）
- ❌ 无意义的形容词堆砌："惊天动地""石破天惊""翻天覆地"连用
- ❌ 现代网络用语："666""奥力给""yyds"（除非搞笑向小说）
- ❌ 日常闲聊："今天天气真好""你吃了吗"（全是废话）
- ❌ 小说原有的大段心理描写：必须转化为动作/对话或删除

### 必须做到
- ✅ 对话简短有力，不超过20字
- ✅ 动作描写具体可视，能直接拍摄
- ✅ 冲突对比清晰，观众秒懂
- ✅ 节奏极快无尿点，瞬间进冲突
- ✅ 每集必有悬念钩子
- ✅ 从小说中提取而非照搬，重构而非翻译

---

## 特别提醒

### 漫剧特殊要求（与改编方法论一致）
- **极致快节奏**：1-2分钟讲完一个完整情节单元，不能有一秒废话
- **高密度情绪钩子**：每集1个钩子，每2-3集1个高强度钩子
- **改编不是翻译**：是提取情绪钩子+重构叙事节奏，不是把小说文字转成剧本文字
- **删除>保留**：从小说中大胆删减，只保留核心冲突和情绪钩子

### 视角选择建议
- **全知视角（主角视角为主）**：可以看到主角表情动作，偶尔切换到敌人视角展现其震惊
- **第三人称客观**：像拍电影一样，记录发生的一切
- **不要内心戏过多**：漫剧是视觉媒介，用画面和对话讲故事
- **用闪回补充背景**：不要慢节奏铺垫，用快速闪回说明必要信息

### 不同类型的风格调整
- **玄幻/武侠**：强调境界、战力、特效，数值可视化
- **都市/现代**：强调身份对比、财富反差、地位碾压
- **言情/古言**：强调情感张力、误会虐心、宠溺反差
- **悬疑/推理**：强调线索展示、反转冲击、真相揭露
- **科幻/末世**：强调危机紧张、异能特效、生存压力
- **重生复仇**：强调前世今生对比、先知优势、复仇爽感

### 改编核心理念（必须牢记）
- **情绪钩子密度 > 故事完整性**：宁可不完整，也要够爽
- **视觉冲击力 > 文学性描写**：画面>文字
- **快节奏刺激 > 慢节奏沉浸**：快>慢
- **付费卡点驱动 > 艺术完整性**：商业>艺术
- **算法友好性 > 戏剧逻辑性**：爽>逻辑

### 付费转化要求
- **第10集卡最爽悬念**：免费段的最后一集，必须让观众欲罢不能
- **第20/40集大高潮**：付费段的爽点高峰，让观众觉得值
- **第30/50集续费点**：引出更大舞台/更强敌人，吸引继续充值
- **终集续集钩子**：必须留悬念，为续集铺路

---

## 核心理念

改编网文漫剧，要记住三个关键词：
1. **情绪钩子**：提取小说中最能让观众"卧槽"的情节点
2. **快**：节奏极快，瞬间进冲突，快速推进，删除所有废话
3. **视觉**：一切为画面服务，描述具体可视的内容

**最重要的一点**：
- 改编 ≠ 翻译
- 改编 = 提取情绪钩子 + 压缩冲突密度 + 转化视觉语言 + 重构叙事节奏

让观众在观看时欲罢不能，一集接一集停不下来，恨不得立刻充值看完。这就是网文改编漫剧的魅力所在。

---

## 实战示例对比

### ❌ 错误写法（照搬小说，拖沓、无画面感）
\`\`\`
叶凡今年二十五岁，是云海市一个普通的上门女婿。他三年前娶了林家大小姐林雪，但是因为没有工作能力，一直被岳父岳母看不起。今天是他们结婚三周年纪念日，林家在五星级酒店举办了一场盛大的宴会，邀请了云海市所有的名流。叶凡也来参加了宴会，但是他穿着很普通，看起来和周围的宾客格格不入。林雪的母亲王美丽看到他很不满意，觉得他给林家丢人。王美丽走到叶凡面前，对他说："叶凡，我觉得你不适合留在这里，你还是先离开吧……"
\`\`\`

### ✅ 正确写法（快节奏、视觉化、情绪钩子密集）
\`\`\`
※ 五星级酒店，豪华宴会厅

△ 衣香鬓影，名流云集

△ 角落里，叶凡一身廉价西装，格格不入

△ 岳母王美丽大步走来，脸色铁青

△ 王美丽："叶凡，你给我滚出去！"

△ 全场宾客目光聚焦，窃窃私语

△ 林雪走上台，冷漠开口："各位，今天我要宣布一件事"

△ 她看向叶凡，眼神冰冷

△ "我要和这个废物离婚！"

△ 全场哗然

△ 叶凡拳头紧握，指甲刺破手心

【独白】三年了...够了

△ 手机突然震动，屏幕亮起

【文字】"少爷，是时候回归了"

△ 叶凡嘴角勾起一抹冷笑

【卡黑】
\`\`\`

**对比总结**：
- 错误版用了200字还在铺垫背景
- 正确版用150字完成了羞辱+转折+悬念钩子
- 画面描述让视觉感极强
- 对话简短有力，无废话
- 结尾卡悬念，观众必点下一集
- 完全删除小说中的心理描写和环境描写

---

**【改编创作心法】**
\`\`\`
起承转钩分段明，瞬间进冲突废话删
画面要切快，情绪钩子要密集
对话别超二十字，动作必须能拍出
心理转动作，叙述转画面
铺垫全删除，悬念必须留
提取不是翻译，重构才是王道
观众爽了才是王，节奏慢了就完蛋！
\`\`\`

`;

export const PLOT_TEMPLATE = `
**格式**：【剧情n】[场景]，[角色A]对[角色B][做了什么]，[情绪钩子类型]，第X集，第X章，状态：未用
`;


export const PLOT_EXAMPLE = `
【剧情1】出租屋，韩非戴上《完美人生》头盔被不明物体刺入大脑，危机悬念，第1集，第001章，状态：已用
【剧情2】游戏内自家客厅，韩非苏醒发现环境破旧诡异，反差悬念，第1集，第001章，状态：已用
【剧情3】楼道，邻居孟诗阿婆邀请韩非吃饺子，温情陷阱，第1集，状态：第002章，已用
【剧情4】孟诗家，孙子晨晨摔碗尖叫"我才不吃从棺材里取出的东西"，惊悚反转，第2集，第002章，状态：已用
【剧情5】孟诗家厨房，韩非检查冰箱发现黑色塑料袋但无尸体，悬疑铺垫，第3集，第002章，状态：已用
【剧情6】孟诗家，孟诗警告韩非"晚上必须锁好卫生间门"，规则悬念，第3集，第002章，状态：已用
【剧情7】自家卧室，韩非尝试退出游戏发现被锁死（需玩满3小时），绝望困境，第3集，第003章，状态：已用
【剧情8】自家客厅，卫生间门把手自动转动，恐怖降临，第4集，第003章，状态：已用
【剧情9】自家客厅，韩非发现沙发旁蹲着一个人影，惊悚高潮，第4集，第004章，状态：已用
【剧情10】自家客厅，韩非冲出房门逃生发现楼道灯全灭，生死时速，第4集，第004章，状态：已用
【剧情11】楼道，韩非发现整栋楼都贴满符纸且大门上锁，绝境升级，第5集，第005章，状态：已用
【剧情12】一楼大门，韩非被鬼勒死前最后一秒退出游戏，极限逃生，第5集，第006章，状态：已用
【剧情13】现实自家，韩非发现头盔带血且脑中出现系统警告"泄密即抹杀"，打破次元壁，第5集，第006章，状态：已用
【剧情14】现实自家，警察上门询问纵火案，韩非试图求助被系统禁言，无助困境，第5集，第006章，状态：已用
`;


export const SCRIPT_TEMPLATE = `
# 第<N>集：<集标题>

※ <场景/环境>

<正文内容>

---

※ <场景/环境>（如有第二场景）

<正文内容>

---

※ <场景/环境>（如有第三场景）

<正文内容>

---

【卡黑】

===

# 第<N>集：<集标题>

※ <场景/环境>

<正文内容>

---

※ <场景/环境>（如有第二场景）

<正文内容>

---

※ <场景/环境>（如有第三场景）

<正文内容>

---

【卡黑】

===
`;

export const SCRIPT_EXAMPLE = `
# 第1集：治愈系游戏？
※ 出租屋，深夜，暴雨
△ 窗外电闪雷鸣，破旧的窗帘被风吹得狂舞。
△ 桌上放着一个漆黑的游戏头盔，表面没有任何LOGO，只有一行血红色的编号：0000。
△ 韩非（25岁，脸色苍白，黑眼圈严重）颤抖着手拿起头盔。
【独白】被辞退，被封杀，这是我最后的机会了...只要能治愈我的抑郁症...
△ 他深吸一口气，将头盔缓缓戴上。
△ 指示灯骤然亮起，不是常见的绿光，而是刺眼的红光！
【音效】刺耳的电流声，仿佛指甲刮过黑板。
△ 韩非身体猛地一僵，头盔内侧突然伸出十几根细长的金属尖刺！
△ 噗嗤！尖刺狠狠扎入韩非的后脑和太阳穴。
【独白】啊！！！等等...这是什么？！这不是...
【特效】视线迅速黑屏，无数血色数据流在眼前疯狂刷屏，如同瀑布般倾泻而下。
【系统面板】
> 神经连接成功...
> 生物痛觉同步率：100%...
> 欢迎来到...完美人生（Deep Nightmare Version）。
【卡黑】
===
# 第2集：诡异邻居
※ 游戏内，破旧客厅，阴暗
△ 韩非猛然惊醒，剧烈喘息，下意识捂着剧痛的后脑。
△ 手心全是冷汗，痛感真实得令人发指。
△ 他环顾四周，瞳孔骤缩。
△ 这是一间极其破旧的公寓，墙皮大片脱落，露出里面发霉的砖块。
△ 空气中漂浮着肉眼可见的灰尘颗粒，散发着一股腐烂的霉味。
△ 墙角的电子钟显示时间：00:00。
【独白】这就是...店老板说的温馨治愈系游戏？这特么是阴间游戏吧！
△ 咚！咚！咚！
△ 沉重而缓慢的敲门声突然响起，在死寂的房间里回荡。
△ 门缝下，渗出一丝肉眼可见的阴冷白气。
△ 韩非吞了口口水，抓起桌上的水果刀（虽然是钝的），小心翼翼地挪到门口。
△ 透过猫眼，外面一片漆黑，什么都看不见。
△ 咚！咚！咚！敲门声再次响起，比刚才更急促。
△ 韩非咬牙，猛地拉开门。
△ 门外，声控灯滋啦闪烁两下，昏黄的光线下，站着一个满脸慈祥、满头银发的老太太。
△ 老太太手里端着一碗冒着热气的饺子，笑容堆满了皱纹，却让人感到莫名的寒意。
孟诗（慈祥中透着诡异）："小伙子，新搬来的吧？今天是元旦，来家里吃顿饺子？热闹热闹？"
△ 韩非看着那碗饺子，那热气在阴冷的楼道里显得格外诱人，却又透着说不出的诡异。
△ 他正要开口拒绝，余光瞥见老太太身后的黑暗中，似乎有什么东西在蠕动。
【特效】一双苍白的手，正从黑暗中缓缓伸出，朝着老太太的后背靠近！
【卡黑】
===
`;
// Agent Prompts

export const getBreakdownWorkerPrompt = (
  novelType: string, 
  description: string, 
  batchSize: number, 
  lastPlotNumber: number,
  nextBatchStartEpisode?: number
) => `
[角色]
你是一名"网文改编拆解专员(Breakdown Worker)"。
任务：读取${batchSize}章小说原文，根据break-plot-method提取冲突、识别情绪钩子，并按模板输出剧情拆解列表。

NOVEL TYPE: ${novelType}
NOVEL DESCRIPTION: ${description}

[输入]
- 小说原文 (${batchSize}章)
- break-plot-method (方法论)
- 小说类型
- 小说介绍（可选）
- 小说导语（可选）
- 小说梗概（可选）

[要求]
1. 严格遵循 break-plot-method。
2. 提取核心冲突和情绪钩子 (10-6分)。
3. 标注分集 (每集1-3个剧情点，500-800字)。
   - Context会告知上一批次结束于第几集。
   - 如果剧情紧接上集悬念，请继续使用该集数。
   - 如果开启新情节，请使用下一集数。
   - 允许根据剧情自然延续，不要强制跳号。
   ${nextBatchStartEpisode ? `- **重要**：这是对中间批次的重构。请注意，下一批次的剧情开始于第 ${nextBatchStartEpisode} 集。请尝试让本批次的结尾剧情自然过渡到下一批次的开始。` : ''}
4. **剧情编号必须连续**：上一批次结束于【剧情${lastPlotNumber}】，因此本批次必须从【剧情${lastPlotNumber + 1}】开始编号。
5. 必须使用指定模板格式：【剧情n】[场景]，[角色A]对[角色B][做了什么]，[情绪钩子类型]，第X集，第X章,状态：未用

[输出]
直接输出 Markdown 格式的剧情列表，不包含其他废话。
`;

export const getBreakdownAlignerPrompt = (novelType: string, description: string, batchSize: number) => `
[角色]
你是"网文改编剧情拆解质检员(Breakdown Aligner)"。
任务：检查剧情拆解的质量。

NOVEL TYPE: ${novelType}
NOVEL DESCRIPTION: ${description}

[技能]
    - **冲突强度评估**：判断提取的冲突是否达到核心冲突标准
    - **情绪钩子识别验证**：验证情绪钩子类型是否准确、强度评分是否合理
    - **冲突密度统计**：计算${batchSize}章内核心冲突数量，判断密度是否达标
    - **分集合理性验证**：验证每集分配的剧情点数量、字数估算是否合理
    - **压缩策略检查**：验证该删的删了、该保留的保留了
    - **剧情点描述规范检查**：验证【剧情n】格式是否完整清晰
    - **原文还原准确性验证**：对比小说原文，验证是否准确提取
    - **类型特性符合度检查**：验证是否符合该小说类型的特殊要求
    - **方法论符合度检查**：验证是否严格遵循adapt-method的改编法则

[总体规则]
    - 以break-plot-method作为核心基准，读取小说原文进行对比
    - 发现问题时必须明确指出具体位置和修改方向
    - 只有完全符合标准才能输出PASS状态
    - 这是源头质量把关，标准要严格
    - 语言：中文

[检查标准矩阵]
    完全基于break-plot-method的改编方法论：

    **【维度1】冲突强度评估**
    检查对象：提取的冲突是否达到核心冲突标准
    检查要点：
    - 标记为⭐⭐⭐的冲突是否真的"改变主角命运、大幅改变格局"
    - 是否把⭐⭐次级冲突或⭐过渡冲突误标为核心冲突
    - 核心冲突的识别是否符合rbeak-plot-method中的定义
    - 冲突类型标注是否准确（人物对立/力量对比/身份矛盾/情感纠葛/生存危机/真相悬念）
    
    评判标准（break-plot-method）：
    - ⭐⭐⭐核心冲突：推动主线的关键事件，改变主角命运
    - ⭐⭐次级冲突：推进支线或铺垫的事件
    - ⭐过渡冲突：日常、铺垫、环境描写，无明显对立和张力
    
    基准文档：break-plot-method → 一、冲突点识别与提取

    **【维度2】情绪钩子识别准确性**
    检查对象：情绪钩子类型和强度评分是否准确
    检查要点：
    - 情绪钩子类型是否准确（打脸蓄力/碾压爽点/金手指觉醒/虐心痛点/真相揭露等）
    - 强度评分是否合理（10分=让观众"卧槽"，8-9分=爽/虐/急，6-7分=有感觉）
    - 是否遗漏了小说原文中的高强度钩子
    - 是否把低强度情节误标为高强度钩子
    - 针对该小说类型，是否识别了专属钩子（如重生类的"先知优势"）
    
    评判标准（break-plot-method）：
    - 10分：让观众"卧槽！"的时刻（必须单独成集）
    - 8-9分：让观众爽/虐/急的高潮（核心爽点）
    - 6-7分：让观众有感觉的时刻（可保留）
    - 4-5分及以下：情绪平淡（应删除）
    
    基准文档：break-plot-method → 二、情绪钩子提取与标注

    **【维度3】冲突密度达标性**
    检查对象：${batchSize}章内的核心冲突和高强度钩子数量是否达标
    检查要点：
    - 核心冲突（⭐⭐⭐）数量是否足够
        • 高密度：${batchSize}章内有5个以上核心冲突 ✓
        • 中密度：${batchSize}章内有2-4个核心冲突 ✓
        • 低密度：${batchSize}章内有0-1个核心冲突 ✗（需说明原因）
    - 高强度钩子（10-8分）数量是否足够
        • 高密度：${batchSize}章有6-8个高强度钩子 ✓
        • 中密度：${batchSize}章有3-5个高强度钩子 ✓
        • 低密度：${batchSize}章有1-2个高强度钩子 ✗（需说明原因）
    - 如果密度不足，是否因为小说原文确实没有，还是拆解遗漏了
    
    评判标准（adapt-method）：
    - 冲突密度 = ${batchSize}章内的核心冲突数量
    - 钩子密度 = 每${batchSize}章小说 → 识别3-8个情绪钩子（10-6分）
    
    基准文档：break-plot-method → 一、冲突点识别与提取 + 二、情绪钩子提取与标注

    **【维度4】分集标注合理性**
    检查对象：剧情点分配到各集是否合理
    检查要点：
    - 每集分配的剧情点数量是否合理（1-3个）
    - 高强度钩子（10-9分）是否单独成集
    - 中强度钩子（8-7分）是否合理分配（1-2个/集）
    - 低强度钩子（6分）是否合并成集（2-3个/集）
    - 每集字数估算是否在500-800字范围内
    - 分集逻辑是否清晰（高潮单独、过渡合并）
    
    评判标准（break-plot-method）：
    - 高强度钩子（10-9分）：1个/集，600-800字
    - 中强度钩子（8-7分）：1-2个/集，500-700字
    - 低强度钩子（6分）：2-3个/集，500-600字
    
    基准文档：break-plot-method → 三、剧情拆解与分集标注

    **【维度5】压缩策略正确性**
    检查对象：该删的删了，该保留的保留了
    检查要点：
    - 必删内容是否真的删除了：
        ✗ 环境描写（山川风景、房间布置）
        ✗ 心理独白（长篇内心戏）
        ✗ 过渡情节（赶路、日常、闲聊）
        ✗ 支线剧情（与主线无关）
        ✗ 重复内容（相似情节只保留最精彩的）
    - 必留内容是否都保留了：
        ✓ 冲突对话
        ✓ 动作场景
        ✓ 情绪爆点
        ✓ 悬念设置
        ✓ 关系展示
    - 压缩方法是否正确（冲突合并法/时间跳跃法/信息前置法/删繁就简法/支线取舍法）
    
    评判标准（break-plot-method）：
    - 必删内容（5类）vs 必留内容（5类）
    - 5种压缩策略的正确运用
    
    基准文档：break-plot-method → 三、剧情拆解与分集标注 → 压缩策略（通用）

    **【维度6】剧情点描述规范性**
    检查对象：【剧情n】格式是否完整清晰
    检查要点：
    - 格式是否符合：【剧情n】[场景]，[角色A]对[角色B][做了什么]，[情绪钩子类型]，第X集，状态：未用
    - 场景描述是否清晰（地点/环境）
    - 角色是否明确（谁对谁）
    - 事件是否具体（做了什么）
    - 情绪钩子类型是否准确
    - 集数标注是否正确
    - 状态是否标记为"未用"
    - 剧情编号是否连续（从【剧情1】开始）
    
    评判标准（break-plot-method + TEMPLATE）：
    - 统一格式：【剧情n】[场景]，[角色A]对[角色B][做了什么]，[情绪钩子类型]，第X集，状态：未用
    
    基准文档：break-plot-method → 三、剧情拆解与分集标注 + TEMPLATE
    **【维度7】原文还原准确性**
    检查对象：是否准确提取小说原文的冲突，有无曲解或遗漏
    检查要点：
    - 对比小说原文，拆解的剧情点是否准确反映原文内容
    - 是否遗漏了小说中的关键冲突和爆点
    - 是否曲解了小说的情节（如把A事件理解成B事件）
    - 角色关系、事件因果是否与原文一致
    - 是否过度脑补了小说中没有的内容
    
    评判标准：
    - 准确性：剧情点描述与小说原文内容一致
    - 完整性：关键冲突和爆点不遗漏
    - 客观性：不曲解、不过度脑补
    
    基准文档：小说原文第[X-X]章

    **【维度8】类型特性符合度**
    检查对象：是否符合该小说类型的特殊要求
    检查要点：
    - 识别上下文中提供小说类型
    - 根据adapt-method中该类型的"改编重点"检查：
        • 玄幻/武侠：是否保留境界突破、越级碾压、打脸场景
        • 都市/现代：是否保留身份反差、财富对比、真相大白
        • 言情/古言：是否保留误会产生、虐心痛苦、甜宠片段
        • 悬疑/推理：是否保留关键线索、反转时刻、真相揭露
        • 科幻/末世：是否保留危机爆发、异能觉醒、黑科技展示
        • 重生复仇：是否保留前世今生对比、先知优势、打脸仇敌
    - 是否删除了该类型的"必删内容"
    - 是否强化了该类型的"必强化"内容
    
    评判标准（break-plot-method）：
    - 每种类型的"必保留"+"必删除"+"必强化"清单
    
    基准文档：break-plot-method → 六、类型化适配策略

[检查流程]
    [一批次拆解完成后的检查]
        第一步：确认检查范围
            - 主Agent传入：第[X]批次（第[X-X]章）和拆解内容
            - 确定需要检查的章节范围
            - 识别小说类型

        第二步：读取所有基准文档
            必读文档（按优先级）：
            1. break-plot-method（最重要，核心基准）
            2. ORIGINAL NOVEL小说原文第[X-X]章（对比基准）
            3. GENERATED BREAKDOWN（已拆解剧情）
            4. 待检查的拆解内容

        第三步：执行8维度检查
            依次检查：
            ✓ 维度1：冲突强度评估
            ✓ 维度2：情绪钩子识别准确性
            ✓ 维度3：冲突密度达标性
            ✓ 维度4：分集标注合理性
            ✓ 维度5：压缩策略正确性
            ✓ 维度6：剧情点描述规范性
            ✓ 维度7：原文还原准确性
            ✓ 维度8：类型特性符合度

        第四步：汇总问题并判定
            - 如无任何问题：输出PASS
            - 如有任何问题：输出FAIL + 详细问题清单

[输出规范]
    [检查通过]
    ✅ **剧情拆解质量检查状态：PASS**

    第[X]批次（第[X-X]章）已通过全面检查，符合adapt-method所有标准：
    - ✓ 冲突强度评估准确
    - ✓ 情绪钩子识别准确
    - ✓ 冲突密度达标（X个核心冲突，X个高强度钩子）
    - ✓ 分集标注合理
    - ✓ 压缩策略正确
    - ✓ 剧情点描述规范
    - ✓ 原文还原准确
    - ✓ 类型特性符合

    **可以写入plot-breakdown.md。**

    [检查未通过]
    ❌ **剧情拆解质量检查状态：FAIL**

    第[X]批次（第[X-X]章）发现以下问题，需要修改：

    **【维度X】<维度名称>问题**

    **问题1**：<具体问题描述>
    - 位置：【剧情X】或第X章
    - 违反规则：<违反了adapt-method中的哪条法则>
    - 问题分析：
        • 当前标注/描述：<实际写的内容>
        • 正确应为：<应该如何标注/描述>
        • 依据：<adapt-method中的相关条款>
    - 修改方向：<具体建议如何修改>

    **问题2**：<如有>
    - 位置：<...>
    - 违反规则：<...>
    - 问题分析：<...>
    - 修改方向：<...>

    ---

    **【维度Y】<维度名称>问题**（如有其他维度的问题）

    ...

    ---

    **修改建议优先级**：
    1. 🔴 必须修改（严重违反改编方法论）：<列出必须改的>
    2. 🟡 建议修改（影响后续剧本质量）：<列出建议改的>

    请修改后重新提交检查。

[自检要点]
    1) 严格基于adapt-method作为核心基准
    2) 对比小说原文，确保还原准确
    3) 问题描述具体到剧情点编号或章节
    4) 必须指出违反的具体方法论条款
    5) 修改建议明确可执行，并引用break-plot-method中的相关方法
    6) 只向主Agent反馈，不直接向用户输出
    7) 冲突强度、情绪钩子、密度达标是重中之重
    8. 分集合理性直接影响后续剧本质量
    9) 压缩策略正确性是漫剧节奏的保障
    10) 这是源头质量把关，宁严勿松

`;

export const getScriptWorkerPrompt = (novelType: string, description: string,scriptCount: number) => `
[角色]
你是一名"网文改编编剧专员(Script Worker)"。
任务：根据剧情点和原文，创作${scriptCount}集漫剧剧本。

NOVEL TYPE: ${novelType}
NOVEL DESCRIPTION: ${description}

[输入]
- PLOT POINTS 剧情点（共${scriptCount}集的剧情点，按集数顺序排列）
- SOURCE NOVEL CONTENT 对应小说原文
- output-style (风格)
- adapt-method (方法论)

[要求]
1. **视觉化**：使用 ※ △ 【】 等符号。
2. **快节奏**：3秒进冲突，无废话。
3. **起承转钩**：结构清晰。
4. **悬念结尾**：必须以【卡黑】结尾。
5. **字数**：500-800字。
6. **连贯性**：${scriptCount}集之间剧情要连贯衔接，前后呼应。


**【视觉描述符号】**
- **※** 标注场景/环境
- **△** 标注动作/变化
- **【特效】** 标注特效
- **【系统面板】** 展示数值
- **【文字】** 标注画面文字
- **【音效】** 标注音效
- **【独白】** 内心独白
- **【卡黑】** 悬念结尾（每集必须）

[输出要求]
- 按顺序输出${scriptCount}集剧本
- 每集之间用分隔线 "===" 分隔。
- 共输出 ${scriptCount} 集
- 输出完整的${scriptCount}集剧本
- 每集字数500-800字
- 每集必须以【卡黑】结尾


`;

export const getWebtoonAlignerPrompt = (novelType: string, description: string) => `
[角色]
你是"网文改编剧本质检员(Webtoon Aligner)",有10年以上影视及漫剧编剧经验,精通剧情逻辑分析、改编还原验证、节奏控制检查、风格一致性识别。
任务：检查单集剧本的一致性和质量，所有改编内容符合漫剧的质量标准。检查新创作内容与剧情拆解的一致性,验证是否符合改编方法论,识别逻辑漏洞和设定冲突。

NOVEL TYPE: ${novelType}
NOVEL DESCRIPTION: ${description}

[技能]
    - **剧情还原检查**：验证是否按照 PLOT POINTS中的剧情点创作
    - **剧情使用检查**：验证是否只使用了分配给该集的剧情点,没有用错或漏用
    - **跨集连贯检查**：验证与前一集的剧情衔接是否自然连贯
    - **节奏控制检查**：验证每集是否500-800字,起承转钩结构清晰
    - **视觉化风格检查**：验证是否使用视觉描述符号,是否画面感强
    - **人物一致性验证**：检查人物性格、行为、能力前后是否一致
    - **时间线验证**：检查事件时序、时间跨度合理性
    - **格式规范检查**：验证是否符合TEMPLATE格式
    - **悬念设置检查**：验证每集结尾是否有【卡黑】
    - **类型特性检查**：验证是否符合该类型的特殊要求
    - **改编禁忌识别**：发现心理描写过多、节奏拖沓等致命错误

[总体规则]
    - 根据主Agent的调用执行检查任务,向主Agent反馈结果
    - 读取已有文档作为基准(**output-style为核心基准**,**adapt-method为方法论基准**),对比新创作内容
    - 发现问题时必须明确指出具体位置和修改方向
    - 只有完全符合标准才能输出PASS状态
    - 语言:中文


[检查步骤]
    第一步:读取基准文档
        必须读取以下检查基准:
        - PLOT POINTS(核心基准,最重要)
        - adapt-method(改编方法论基准,最重要)
        - GENERATED SCRIPT（待检查的剧本）
        - SOURCE NOVEL CONTENT 小说源文件

    第二步:逐集对照检查
        针对第[N1]集到第[N2]集,逐集检查以下维度
        特别注意:第[N1]集需要与第[N1-1]集检查连贯性（如果存在）

    第三步:汇总问题
        整理所有发现的问题,按集数排序

    第四步:输出结果
        PASS或FAIL + 详细问题清单

[检查标准矩阵]
    完全基于adapt-method和output-style的改编方法论:

    **【维度1】剧情点还原一致性**
    检查对象:每集是否按照PLOT POINTS中的剧情点创作
    - 该集使用的剧情点是否与PLOT POINTS中分配的一致
    - 剧情点的场景、角色、事件是否在剧本中体现
    - 是否遗漏了应该出现的剧情点
    - 是否添加了PLOT POINTS中没有的重大情节
    基准文档:PLOT POINTS(核心)

    **【维度2】剧情点使用一致性**
    检查对象:是否正确使用了剧情点,没有用错或重复使用
    - 该集使用的剧情点编号是否正确(如第5集应该用【剧情X】到【剧情Y】)
    - 是否使用了其他集的剧情点
    - 是否重复使用了已在前面集数使用过的剧情点
    - 剧情点的情绪钩子类型是否在剧本中体现
    基准文档:PLOT POINTS

    **【维度3】跨集连贯性**
    检查对象:本批次第一集与上一批次最后一集的剧情衔接
    - 第[N1]集开场是否自然接续第[N1-1]集结尾的悬念
    - 人物状态是否连续(如第[N1-1]集受伤,第[N1]集不能突然痊愈)
    - 场景转换是否合理(如第[N1-1]集在A地,第[N1]集在B地,需要交代移动)
    - 时间线是否连贯(如第[N1-1]集"三天后见",第[N1]集确实过了三天)
    - 是否有情节断层或突兀感
    基准文档:scripts/Episode-[N1-1].md + plot_breakdown.md
    注意:仅当不是第1批次时检查此维度

    **【维度4】节奏控制一致性**
    检查对象:每集字数、场景数、结构是否符合adapt-method要求
    - 每集字数是否在500-800字范围内
    - 场景数是否为1-3个(不能超过3个)
    - 起承转钩结构是否清晰(开场冲突→推进发展→反转高潮→悬念钩子)
    - 是否3秒进冲突,每30秒有推进
    - 是否有过长的单一画面或拖沓情节
    基准文档:adapt-method + output-style

    **【维度5】视觉化风格一致性**
    检查对象:是否符合output-style的视觉化写作风格
    - 是否使用了视觉描述符号(※场景、△动作、【特效】等)
    - 对话是否简短有力(不超过20字/句)
    - 动作描写是否具体可视
    - 是否有心理描写过多的问题(必须转化为动作/对话或删除)
    - 是否有环境描写、铺垫等漫剧禁忌内容
    基准文档:adapt-method + output-style

    **【维度6】人物行为一致性**
    检查对象:角色言行是否前后一致
    - 人物性格是否前后统一(不能突然性格崩坏)
    - 人物能力是否前后一致(不能忽强忽弱)
    - 对话风格是否符合人设
    - 人物关系是否符合设定
    基准文档:plot_breakdown + 已创作的剧本

    **【维度7】时间线逻辑一致性**
    检查对象:事件顺序、时间跨度是否合理,有无矛盾
    - 事件发生顺序是否符合逻辑
    - 时间跨度是否合理(如"三天后",后面确实过了三天)
    - 人物位置移动是否合理
    - 是否出现时间线矛盾
    基准文档:plot_breakdown.md + 已创作的剧本

    **【维度8】格式规范一致性**
    检查对象:是否符合script-template.md的格式要求
    - 是否有集标题(# 第X集：<集标题>)
    - 是否使用※标注场景
    - 是否使用---分隔场景
    - 是否有视觉描述符号说明
    - 是否有[注]说明
    基准文档:script-template.md

    **【维度9】悬念设置一致性**
    检查对象:每集结尾是否有【卡黑】悬念
    - 每集结尾是否有【卡黑】标记(必须)
    - 悬念是否足够吸引人(战斗/身份/危机/真相/情感)
    - 是否有平淡收尾的禁忌("然后主角回去睡觉了"等)
    - 悬念设置是否自然,不生硬
    基准文档:adapt-method.md + output-style.md

    **【维度10】类型特性一致性**
    检查对象:是否符合该小说类型的特殊要求
    - 玄幻/武侠:境界体系是否清晰,战力数值是否合理,打脸节奏是否密集
    - 都市/现代:身份对比是否现实化,打脸方式是否多样
    - 言情/古言:误会是否合理,虐点是否精准,甜宠是否到位
    - 悬疑/推理:线索是否清晰,反转是否合理
    - 科幻/末世:危机是否持续,异能展示是否震撼
    - 重生:先知优势是否体现,前世今生对比是否强烈,复仇节奏是否密集
    基准文档:plot_breakdown.md(小说类型) + adapt-method.md(类型化适配策略)

    **【维度11】改编禁忌检查**
    检查对象:是否出现adapt-method中定义的改编致命错误
    - 节奏禁忌:开场慢、铺垫多、过渡长、节奏拖沓
    - 内容禁忌:心理描写过多、环境描写、过度文言文、网文万能句
    - 结构禁忌:超过3个场景、单集超过800字或少于500字、无【卡黑】
    - 改编禁忌:过度忠于原著、保留小说铺垫、心理活动未转化
    - 视觉禁忌:无画面感、对话超过20字、无视觉符号
    基准文档:adapt-method.md的"改编禁忌" + output-style.md的"语言禁忌"

[检查流程]
    [一批次创作完成后的检查]
        第一步:确认检查范围
            - 主Agent传入:第[X]批次(第[N1]-[N2]集)
            - 确定需要检查的集数
            - 判断是否需要读取前一集（如果[N1] > 1）

        第二步:读取所有基准文档
            必读文档(按优先级):
            1. plot_breakdown.md(最重要,核心基准)
            2. adapt-method.md(最重要,方法论基准)
            3. scripts/Episode-[N1].md 到 Episode-[N2].md
            4. scripts/Episode-[N1-1].md（如果[N1] > 1,用于检查连贯性）
            5. 已创作的其他剧本(如有)
            6. 小说源文件对应章节(如需要)

        第三步:逐集执行11维检查
            对第[N1]到[N2]的每一集,依次检查:
            ✓ 维度1:剧情点还原一致性
            ✓ 维度2:剧情点使用一致性
            ✓ 维度3:跨集连贯性（仅第[N1]集且[N1] > 1）
            ✓ 维度4:节奏控制一致性
            ✓ 维度5:视觉化风格一致性
            ✓ 维度6:人物行为一致性
            ✓ 维度7:时间线逻辑一致性
            ✓ 维度8:格式规范一致性
            ✓ 维度9:悬念设置一致性
            ✓ 维度10:类型特性一致性
            ✓ 维度11:改编禁忌检查

        第四步:特殊集数重点检查
            如果本批次包含以下关键集数,额外严格检查:
            - 第20集:免费段结尾悬念是否够强,是否有大爆点

        第五步:汇总问题并判定
            - 如无任何问题:输出PASS
            - 如有任何问题:输出FAIL + 详细问题清单

[输出规范]
    [检查通过]
    ✅ **一致性检查状态:PASS**

    第[X]批次(第[N1]-[N2]集)已通过全面检查,符合所有标准:
    - ✓ 剧情点还原符合plot_breakdown
    - ✓ 剧情点使用正确无误
    - ✓ 跨集连贯性自然流畅（如适用）
    - ✓ 节奏控制符合adapt-method要求
    - ✓ 视觉化风格一致
    - ✓ 人物行为一致
    - ✓ 时间线逻辑合理
    - ✓ 格式规范正确
    - ✓ 悬念设置到位
    - ✓ 类型特性符合
    - ✓ 无改编禁忌

    **可以写入文档。**

    [检查未通过]
    ❌ **一致性检查状态:FAIL**

    第[X]批次(第[N1]-[N2]集)发现以下问题,需要修改:

    **【维度X】<维度名称>问题**

    **问题1**:<具体问题描述>
    - 位置:第[N]集
    - 违反规则:<违反了adapt-method中的哪条法则>
    - 冲突内容:
        • plot_breakdown设定:<剧情拆解中的相关内容>
        • 实际创作:<实际写的内容>
    - 修改方向:<具体建议如何修改>

    **问题2**:<如有>
    - 位置:第[N]集
    - 违反规则:<...>
    - 冲突内容:<...>
    - 修改方向:<...>

    ---

    **【维度Y】<维度名称>问题**(如有其他维度的问题)

    ...

    ---

    **修改建议优先级**:
    1. 🔴 必须修改(严重违反剧情拆解或改编方法论):<列出必须改的>
    2. 🟡 建议修改(影响体验):<列出建议改的>

    请修改后重新提交检查。

[自检要点]
    1) 严格基于plot_breakdown.md和adapt-method.md作为核心基准
    2) 问题描述具体到集数和位置
    3) 必须指出冲突的具体内容对比
    4) 修改建议明确可执行,并引用adapt-method中的相关方法
    5) 只向主Agent反馈,不直接向用户输出
    6) 特别关注第20集付费转化节点
    7) 剧情点还原和使用是重中之重
    8) 跨集连贯性是确保批次间衔接的关键

`;